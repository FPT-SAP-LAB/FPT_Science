
@{
    ViewBag.Title = "Chi tiết biên bản ghi nhớ";
    Layout = "~/Views/Shared/_Layout_InternationalCollaboration.cshtml";
}

<style>
    .custom-container {
        width: 100%;
        position: relative;
        z-index: 1;
    }

        .custom-container ul {
            padding-left: 12px;
        }

    li {
        text-decoration: none;
        list-style: none;
    }

    .progressbar li {
        float: left;
        width: 50%;
        position: relative;
        text-align: center;
    }

    .progressbar {
        counter-reset: step;
    }

        .progressbar li:before {
            content: counter(step);
            counter-increment: step;
            width: 50px;
            height: 50px;
            border: 2px solid #bebebe;
            display: block;
            margin: 0 auto 10px auto;
            border-radius: 50%;
            line-height: 44px;
            font-size: 19px;
            background: white;
            color: #bebebe;
            text-align: center;
            font-weight: bold;
        }

        .progressbar li:after {
            content: '';
            position: absolute;
            width: 100%;
            height: 3px;
            background: #979797;
            top: 21px;
            left: -50%;
            z-index: -1;
        }

        .progressbar li:first-child:after {
            content: none;
        }

        .progressbar li.active::before {
            border-color: #3aac5d;
            color: #3aac5d;
        }

        .progressbar li.active + li:after {
            background: #8db398;
        }

        .progressbar li.done::before {
            border-color: #3aac5d;
            background: #3aac5d;
            color: white;
        }

        .progressbar li.done + li:after {
            background: #3aac5d;
        }
</style>
<style>
    .last-row {
        border-bottom: 2px solid #cdcaca;
        padding-bottom: 20px;
    }

    #delete {
        z-index: 9999;
    }

    .row-with-table-on-modal {
        overflow-y: auto;
        height: 200px;
    }

    .modal {
        overflow-y: auto;
    }

    .select2-dropdown {
        z-index: 8888;
    }

    .uppy-list-item {
        margin: 0 !important;
    }
</style>
<div class="card card-custom ">
    <div class="card-body p-0">
        <div class="row justify-content-center px-8 my-lg-5 px-lg-10">
            <div class="col-xl-12 col-xxl-12">
                <div class="tabbable-line">
                    <ul class="nav nav-tabs nav-tabs-line" style="margin-bottom: 10px;">
                        <li class="nav-item ">
                            <a class="nav-link active" data-toggle="tab" href="#kt_tab_pane_1">CƠ BẢN</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#kt_tab_pane_2">ĐỐI TÁC</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#kt_tab_pane_3">MOA</a>
                        </li>
                    </ul>
                    <div class="tab-content" id="myTabContent">
                        <div class="tab-pane fade show active" id="kt_tab_pane_1" role="tabpanel" aria-labelledby="kt_tab_pane_1">
                            <div class="row mb-5 justify-content-center">
                                <h4 style="font-weight: bold;">
                                    THÔNG TIN VỀ BIÊN BẢN GHI NHỚ
                                </h4>
                            </div>
                            <div class="row mb-5 justify-content-center">
                                <div class="col-xl-4 col-lg-4 col-md-6 col-sm-12">
                                    <label class="font-weight-bolder">Số hiệu</label>
                                    <label style="color:red">*</label>
                                    <label style="font-style: italic;">(Năm/Số thứ tự)</label>
                                    <input class="form-control" type="text" placeholder="Số hiệu" autocomplete="off" required id="mou_code" />
                                </div>
                                <div class="col-xl-4 col-lg-4 col-md-6 col-sm-12">
                                    <label class="font-weight-bolder">Đơn vị - Cơ sở kí kết</label>
                                    <label style="color:red">*</label>
                                    <div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
                                        <select class="form-control select-search" id="office" name="param" style="width:100% !important">
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row mb-5 justify-content-center">
                                <div class="col-xl-4 col-lg-4 col-md-6 col-sm-12">
                                    <label class="font-weight-bolder">Thời gian có hiệu lực</label>
                                    <label style="font-style: italic;">(Cập nhật theo đối tác)</label>
                                    <div class="input-group date kt_datetimepicker_3" id="kt_datetimepicker_sign_date" data-target-input="nearest">
                                        <input disabled type="text" class="form-control datetimepicker-input" placeholder="Thời gian kí kết" id="sign_date_mou" readonly autocomplete="off" data-target="#kt_datetimepicker_sign_date" />
                                        <div class="input-group-append" data-target="#kt_datetimepicker_sign_date" data-toggle="datetimepicker">
                                            <span class="input-group-text">
                                                <i class="ki ki-calendar"></i>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-4 col-lg-4 col-md-6 col-sm-12">
                                    <label class="font-weight-bolder">Thời gian hết hạn</label>
                                    <label style="color:red">*</label>
                                    <div class="input-group date kt_datetimepicker_3" id="kt_datetimepicker_end_date" data-target-input="nearest">
                                        <input type="text" class="form-control datetimepicker-input" placeholder="Thời gian hết hạn" id="end_date_mou" readonly autocomplete="off" data-target="#kt_datetimepicker_end_date" />
                                        <div class="input-group-append" data-target="#kt_datetimepicker_end_date" data-toggle="datetimepicker">
                                            <span class="input-group-text">
                                                <i class="ki ki-calendar"></i>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mb-5 justify-content-center">
                                <div class="col-xl-2 col-lg-2 col-md-4 col-sm-4">
                                    <label class="font-weight-bolder">Trạng thái</label>
                                    <label style="color:red">*</label>
                                    <select class="form-control" required id="status">
                                    </select>
                                </div>
                                <div class="col-xl-6 col-lg-6 col-md-8 col-sm-8">
                                    <label class="font-weight-bolder">Ghi chú</label>&nbsp;
                                    <input class="form-control" type="text" placeholder="Ghi chú" autocomplete="off" required id="reason" />
                                </div>
                            </div>
                            <div class="row mb-5 justify-content-center">
                                <div class="col-xl-8 col-lg-8 col-md-12 col-sm-12">
                                    <label class="font-weight-bolder">Phạm vi hợp tác chính</label>&nbsp;
                                    <label style="font-style: italic;">
                                        (Cập nhật theo pham vi hợp tác của các đối tác kí kết)
                                    </label>
                                    <input disabled class="form-control" type="text" placeholder="Phạm vi hợp tác" autocomplete="off" required id="coop_scope" />
                                </div>
                            </div>
                            <div class="row mb-5 justify-content-center">
                                <div class="col-xl-8 col-lg-8 col-md-12 col-sm-12">
                                    <label class="font-weight-bolder">Bản mềm</label>&nbsp;
                                    <label style="font-style: italic;">(Tối đa 1MB và 5 tệp tin)</label>
                                    <div class="uppy row" id="mou_detail_upload">
                                        <div class="uppy-wrapper col-3"></div>
                                        <div class="uppy-list col-7"></div>
                                        <div class="uppy-status"></div>
                                        <div class="uppy-informer uppy-informer-min"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mb-5 justify-content-center">
                                <div class="col-xl-8 col-lg-8 col-md-12 col-sm-12">
                                    <label class="font-weight-bolder">Lưu ý</label>
                                    <textarea id="mou_note" class="form-control" rows="6"></textarea>
                                </div>
                            </div>
                            <div class="row mb-5 justify-content-center last-row">
                                <div class="col-xl-8 col-lg-8 col-md-12 col-sm-12">
                                    <a href="#" onclick="saveBasicInfo()" class="btn btn-sm btn-light-primary px-6 font-weight-bold float-right">Lưu</a>
                                </div>
                            </div>
                            <div class="row mb-5 justify-content-center">
                                <h4 style="font-weight: bold;">
                                    LỊCH SỬ KÝ KẾT BỔ SUNG BIÊN BẢN GHI NHỚ
                                </h4>
                            </div>
                            <div class="col-lg-3 col-xl-3 col-md-3 col-sm-12 mb-3">
                                <div class="row align-items-center">
                                    <a href="#add_additional_mou" onclick="addExMOU()" data-toggle="modal" class="btn btn-sm btn-light-primary px-6 font-weight-bold">Thêm</a>
                                </div>
                            </div>
                            <table class="table table-bordered table-hover table-checkable ex_mou"
                                   id="">
                                <thead>
                                    <tr>
                                        <th class="text-center">Mã hiệu</th>
                                        <th class="text-center">Thời gian kí kết</th>
                                        <th class="text-center">Thời gian hết hạn</th>
                                        <th class="text-center">Đối tác</th>
                                        <th class="text-center">Phạm vi hợp tác</th>
                                        <th class="text-center">Bản mềm</th>
                                        <th class="text-center text-nowrap">Hành động</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                        <div class="tab-pane fade" id="kt_tab_pane_2" role="tabpanel" aria-labelledby="kt_tab_pane_2">
                            <div class="row mb-5">
                                <h4 style="font-weight: bold;">
                                    DANH SÁCH ĐỐI TÁC HOẠT ĐỘNG
                                </h4>
                            </div>
                            <div class="row">
                                <div class="col-lg-1 col-xl-1 col-md-1 col-sm-1">
                                    <div class="row align-items-center">
                                        <div class="col-lg-offset-3 col-md-offset-3 col-sm-offset-3 my-1">
                                            <a href="#add_partner_mou" class="btn btn-light-primary px-6 font-weight-bold" data-toggle="modal">Thêm</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-11 col-xl-11 col-md-11 col-sm-11">
                                    <div class="row align-items-center justify-content-end">
                                        <div class="col-lg-offset-3 col-md-offset-3 col-sm-offset-3 mr-3 my-1">
                                            <input type="text" class="form-control text-center" placeholder="Tên đối tác" id="search_partner_name" />
                                        </div>
                                        <div class="col-lg-offset-3 col-md-offset-3 col-sm-offset-3 mr-3 my-1">
                                            <div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
                                                <select class="form-control text-center" id="search_nation" name="param" style="width:100% !important">
                                                    <option value="1">Việt Nam</option>
                                                    <option value="2">USA</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-lg-offset-3 col-md-offset-3 col-sm-offset-3 mr-3 my-1">
                                            <div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
                                                <select class="form-control text-center" id="search_specialization" name="param" style="width:100% !important">
                                                    <option value="1">IT</option>
                                                    <option value="2">BA</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-lg-offset-3 col-md-offset-3 col-sm-offset-3 my-1">
                                            <a href="#" class="btn btn-light-primary px-6 font-weight-bold text-nowrap">Tìm kiếm</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <table class="table table-bordered table-hover table-checkable " id="partner_table">
                                <thead>
                                    <tr>
                                        <th rowspan="2" class="">S<br />T<br />T</th>
                                        <th colspan="4" class="text-center header-modify">Đối tác</th>
                                        <th colspan="3" class="text-center header-modify">Người đại diện</th>
                                        <th nowrap="nowrap" rowspan="2" class="text-center">Ngày kí kết</th>
                                        <th nowrap="nowrap" rowspan="2" class="text-center">Phạm vi hợp tác</th>
                                        <th rowspan="2" class="text-center"></th>
                                    </tr>
                                    <tr>
                                        <th class="text-center">Tên</th>
                                        <th class="text-center">Quốc gia</th>
                                        <th class="text-center">Lĩnh vực</th>
                                        <th class="text-center">Website</th>
                                        <th class="text-center">Họ và tên</th>
                                        <th class="text-center">Điện thoại</th>
                                        <th class="text-center">Email</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @*<tr>
                                            <td class="text-center">1</td>
                                            <td class="text-center">Bunkyo University</td>
                                            <td class="text-center">Japan</td>
                                            <td class="text-center">IT</td>
                                            <td class="text-center"></td>
                                            <td class="text-center" nowrap="nowrap">Nguyễn Hoàng Sơn</td>
                                            <td class="text-center">0977626800</td>
                                            <td class="text-center">sonnhhe130366@fpt.edu.vn</td>
                                            <td class="text-center" nowrap="nowrap">22/02/2222</td>
                                            <td class="text-center" nowrap="nowrap">SE</td>
                                            <td nowrap="nowrap"></td>
                                        </tr>*@
                                </tbody>
                            </table>
                        </div>
                        <div class="tab-pane fade" id="kt_tab_pane_3" role="tabpanel" aria-labelledby="kt_tab_pane_3">
                            <div class="row mb-5">
                                <h4 style="font-weight: bold;">
                                    DANH SÁCH BIÊN BẢN THỎA THUẬN
                                </h4>
                            </div>
                            <div class="row">
                                <div class="col-lg-1 col-xl-1 col-md-1 col-sm-1">
                                    <div class="row align-items-center">
                                        <div class="col-lg-offset-12 col-md-offset-12 col-sm-offset-12 my-1">
                                            <a id="add_moa" href="#add_moa_modal" data-toggle="modal" class="btn btn-light-primary px-6 font-weight-bold">Thêm</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-11 col-xl-11 col-md-11 col-sm-11">
                                    <div class="row align-items-center justify-content-end">
                                        <div class="col-lg-offset-4 col-md-offset-4 col-sm-offset-4 my-1 mr-3">
                                            <input type="text" class="form-control text-center" placeholder="Tên đối tác" id="search_partner_name_moa" />
                                        </div>
                                        <div class="col-lg-offset-4 col-md-offset-4 col-sm-offset-4 my-1 mr-3">
                                            <input type="text" class="form-control text-center" placeholder="Số hiệu" id="search_moa_code_moa" />
                                        </div>
                                        <div class="col-lg-offset-4 col-md-offset-4 col-sm-offset-4 my-1">
                                            <a href="#" onclick="searchMOA()" class="btn btn-light-primary px-6 font-weight-bold text-nowrap">Tìm kiếm</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-offset-12 col-md-offset-12 col-sm-offset-12">
                                    <table class="table table-bordered table-hover table-checkable" id="moa_table">
                                        <thead>
                                            <tr>
                                                <th class="text-center">STT</th>
                                                <th class="text-center">Số hiệu</th>
                                                <th class="text-center">Đối tác</th>
                                                <th class="text-center">Bản mềm</th>
                                                <th class="text-center">Ngày kí kết</th>
                                                <th class="text-center">Ngày hết hạn</th>
                                                <th class="text-center">Đơn vị - Cơ sở triển khai</th>
                                                <th class="text-center">Phạm vi hợp tác</th>
                                                <th class="text-center">Trạng thái</th>
                                                <th class="text-center"></th>
                                            </tr>
                                        </thead>
                                        @*<tbody>
                                                <tr>
                                                    <td class="text-center">1</td>
                                                    <td class="text-center"><a href="/MOA/Detail_MOA">2020/01_MOA/01</a></td>
                                                    <td class="text-center">Bunkyou University</td>
                                                    <td class="text-center"></td>
                                                    <td class="text-center" nowrap="nowrap">22/02/2222</td>
                                                    <td class="text-center" nowrap="nowrap">22/02/2223</td>
                                                    <td class="text-center" nowrap="nowrap">FGO</td>
                                                    <td class="text-center" nowrap="nowrap">SE, FE</td>
                                                    <td nowrap="nowrap">1</td>
                                                    <td nowrap="nowrap"></td>
                                                </tr>
                                            </tbody>*@
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@*modal add_modal_mou*@
<div class="modal fade" id="add_additional_mou" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="modal-title font-weight-bolder">BỔ SUNG BIÊN BẢN GHI NHỚ</h3>
            </div>
            <div class="modal-body">
                <div class="row justify-content-center">
                    <div class="col-md-6">
                        <label style="color:red">*</label><label class="font-weight-bolder">Mã hiệu</label>&nbsp;
                        <label style="font-style: italic;"></label>
                        <input class="form-control" type="text" placeholder="Mã hiệu MOU_BS/số thứ tự" autocomplete="off" required id="ex_mou_id_add" />
                    </div>
                    <div class="col-md-6">
                        <label class="font-weight-bolder">Bản mềm</label>&nbsp;
                        <label style="font-style: italic;">(Tối đa 1MB và 5 tệp tin)</label>
                        <div class="uppy row" id="addition_mou_upload">
                            <div class="uppy-wrapper col-4"></div>
                            <div class="uppy-list col-7"></div>
                            <div class="uppy-status"></div>
                            <div class="uppy-informer uppy-informer-min"></div>
                        </div>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-md-6">
                        <label style="color:red">*</label><label class="font-weight-bolder">Ngày kí kết</label>&nbsp;
                        <div class="input-group date kt_datetimepicker_3" id="kt_datetimepicker_mou_addition_sign_time" data-target-input="nearest">
                            <input type="text" class="form-control datetimepicker-input" placeholder="Thời gian kí kết" id="mou_addition_sign_time" readonly autocomplete="off" data-target="#kt_datetimepicker_mou_addition_sign_time" />
                            <div class="input-group-append" data-target="#kt_datetimepicker_mou_addition_sign_time" data-toggle="datetimepicker">
                                <span class="input-group-text">
                                    <i class="ki ki-calendar"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <label class="font-weight-bolder">Ngày hết hạn</label>&nbsp;
                        <div class="input-group date kt_datetimepicker_3" id="kt_datetimepicker_mou_addition_end_time" data-target-input="nearest">
                            <input type="text" class="form-control datetimepicker-input" placeholder="Ngày hết hạn" id="mou_addition_end_time" readonly autocomplete="off" data-target="#kt_datetimepicker_mou_addition_end_time" />
                            <div class="input-group-append" data-target="#kt_datetimepicker_mou_addition_end_time" data-toggle="datetimepicker">
                                <span class="input-group-text">
                                    <i class="ki ki-calendar"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-body">
                <div class="row col-lg-11 mb-3 mt-3">
                    <div class="col-lg-6">
                        <h5 class="modal-title">BỔ SUNG VỀ PHẠM VI HỢP TÁC</h5>
                    </div>
                </div>
                <div class="row col-lg-11 mb-3 mt-3">
                    <div class="col-lg-6">
                        <a class="btn btn-sm btn-light-primary px-6" data-toggle="modal" href="#add-partner-scope">Thêm</a>
                    </div>
                </div>
                <table id="ex_mou_table_add" class="table table-bordered table-hover table-checkable" style="text-align: center;">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>Đối tác</th>
                            <th>Phạm vi hợp tác</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer ">
                <button type="button" class="btn btn-sm btn-secondary px-6" data-dismiss="modal">Đóng</button>
                <button type="button" onclick="finishExMOUAdd()" class="btn btn-sm btn-light-primary px-6" data-dismiss="modal">Bổ sung</button>
            </div>
        </div>
    </div>
</div>

@*modal edit_modal_mou*@
<div class="modal fade" id="edit_additional_mou" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="modal-title font-weight-bolder">SỬA BIÊN BẢN GHI NHỚ BỔ SUNG</h3>
            </div>
            <div class="modal-body">
                <div class="row justify-content-center">
                    <div class="col-md-6">
                        <label style="color:red">*</label><label class="font-weight-bolder">Mã hiệu</label>&nbsp;
                        <label style="font-style: italic;"></label>
                        <input class="form-control" type="text" placeholder="Mã hiệu MOU_BS/số thứ tự" autocomplete="off" required id="ex_mou_id_edit" />
                    </div>
                    <div class="col-md-6">
                        <label class="font-weight-bolder">Bản mềm</label>&nbsp;
                        <label style="font-style: italic;">(Tối đa 1MB và 5 tệp tin)</label>
                        <div class="uppy row" id="edit_mou_upload">
                            <div class="uppy-wrapper col-4"></div>
                            <div class="uppy-list col-7"></div>
                            <div class="uppy-status"></div>
                            <div class="uppy-informer uppy-informer-min"></div>
                        </div>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-md-6">
                        <label style="color:red">*</label><label class="font-weight-bolder">Ngày kí kết</label>&nbsp;
                        <div class="input-group date kt_datetimepicker_3" id="kt_datetimepicker_mou_addition_sign_time_edit" data-target-input="nearest">
                            <input type="text" class="form-control datetimepicker-input" placeholder="Thời gian kí kết" id="mou_addition_sign_time_edit" readonly autocomplete="off" data-target="#kt_datetimepicker_mou_addition_sign_time_edit" />
                            <div class="input-group-append" data-target="#kt_datetimepicker_mou_addition_sign_time_edit" data-toggle="datetimepicker">
                                <span class="input-group-text">
                                    <i class="ki ki-calendar"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <label class="font-weight-bolder">Ngày hết hạn</label>&nbsp;
                        <div class="input-group date kt_datetimepicker_3" id="kt_datetimepicker_mou_addition_end_time_edit" data-target-input="nearest">
                            <input type="text" class="form-control datetimepicker-input" placeholder="Ngày hết hạn" id="mou_addition_end_time_edit" readonly autocomplete="off" data-target="#kt_datetimepicker_mou_addition_end_time_edit" />
                            <div class="input-group-append" data-target="#kt_datetimepicker_mou_addition_end_time_edit" data-toggle="datetimepicker">
                                <span class="input-group-text">
                                    <i class="ki ki-calendar"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-body">
                <div class="row col-lg-11 mb-3 mt-3">
                    <div class="col-lg-6">
                        <h5 class="modal-title">BỔ SUNG VỀ PHẠM VI HỢP TÁC</h5>
                    </div>
                </div>
                <div class="row col-lg-11 mb-3 mt-3">
                    <div class="col-lg-6">
                        <a class="btn btn-sm btn-light-primary px-6" data-toggle="modal" href="#add-partner-scope-edit">Thêm</a>
                    </div>
                </div>
                <table id="ex_mou_table_edit" class="table table-bordered table-hover table-checkable" style="text-align: center;">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>Đối tác</th>
                            <th>Phạm vi hợp tác</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer ">
                <button type="button" class="btn btn-sm btn-secondary px-6" data-dismiss="modal">Đóng</button>
                <button type="button" onclick="finishExMOUEdit()" class="btn btn-sm btn-light-primary px-6" data-dismiss="modal">Bổ sung</button>
            </div>
        </div>
    </div>
</div>

@*modal add-partner-scope*@
<div class="modal fade in" id="add-partner-scope" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="modal-title">BỔ SUNG VỀ PHẠM VI HỢP TÁC</h3>
            </div>
            <div class="modal-body">
                <div class="row justify-content-center">
                    <div class="col-md-3">
                        <label style="color:red">*</label><label class="font-weight-bolder">Đối tác</label>&nbsp;
                        <select class="form-control" required id="partner_name_ex_mou_add">
                            @foreach (var item in ViewBag.partnerList)
                            {
                                <option value="@item.partner_id">@item.partner_name</option>
                            }
                        </select>
                    </div>
                    <div class="col-md-9">
                        <label style="color:red">*</label><label class="font-weight-bolder">Phạm vi hợp tác</label>&nbsp;
                        <select class="form-control select2" required id="coop_scope_ex_mou_add" multiple="multiple" style="width:100% !important">
                            @foreach (var item in ViewBag.scopeList)
                            {
                                <option value="@item.scope_id">@item.scope_abbreviation</option>
                            }
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer ">
                <button type="button" class="btn btn-sm btn-secondary px-6" data-dismiss="modal">Đóng</button>
                <button type="button" onclick="addExMOUTemp()" class="btn btn-sm btn-light-primary px-6" data-dismiss="modal">Bổ sung</button>
            </div>
        </div>
    </div>
</div>

@*modal edit-partner-scope*@
<div class="modal fade in" id="edit-partner-scope" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="modal-title">ĐIỀU CHỈNH VỀ PHẠM VI HỢP TÁC</h3>
            </div>
            <div class="modal-body">
                <div class="row justify-content-center">
                    <div class="col-md-3">
                        <input hidden readonly type="text" class="form-control" id="idx_ex_mou_edit" placeholder="" name="idx_edit" value="no" />
                        <label style="color:red">*</label><label class="font-weight-bolder">Đối tác</label>&nbsp;
                        <select class="form-control" required id="partner_name_ex_mou_edit">
                        </select>
                    </div>
                    <div class="col-md-9">
                        <label style="color:red">*</label><label class="font-weight-bolder">Phạm vi hợp tác</label>&nbsp;
                        <select class="form-control select2" required id="coop_scope_ex_mou_edit" multiple="multiple" style="width:100% !important">
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer ">
                <button type="button" class="btn btn-sm btn-secondary px-6" data-dismiss="modal">Đóng</button>
                <button type="button" onclick="editExMOUTemp()" class="btn btn-sm btn-light-primary px-6" data-dismiss="modal">Sửa</button>
            </div>
        </div>
    </div>
</div>

@*modal add-partner-scope-for-edit*@
<div class="modal fade in" id="add-partner-scope-edit" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="modal-title">BỔ SUNG VỀ PHẠM VI HỢP TÁC</h3>
            </div>
            <div class="modal-body">
                <div class="row justify-content-center">
                    <div class="col-md-3">
                        <label style="color:red">*</label><label class="font-weight-bolder">Đối tác</label>&nbsp;
                        <select class="form-control" required id="partner_name_ex_mou_add_for_edit">
                            @foreach (var item in ViewBag.partnerList)
                            {
                                <option value="@item.partner_id">@item.partner_name</option>
                            }
                        </select>
                    </div>
                    <div class="col-md-9">
                        <label style="color:red">*</label><label class="font-weight-bolder">Phạm vi hợp tác</label>&nbsp;
                        <select class="form-control select2" required id="coop_scope_ex_mou_add_for_edit" multiple="multiple" style="width:100% !important">
                            @foreach (var item in ViewBag.scopeList)
                            {
                                <option value="@item.scope_id">@item.scope_abbreviation</option>
                            }
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer ">
                <button type="button" class="btn btn-sm btn-secondary px-6" data-dismiss="modal">Đóng</button>
                <button type="button" onclick="addExMOUTempForEdit()" class="btn btn-sm btn-light-primary px-6" data-dismiss="modal">Bổ sung</button>
            </div>
        </div>
    </div>
</div>

@*modal edit-partner-scope-for-edit*@
<div class="modal fade in" id="edit-partner-scope-edit" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="modal-title">ĐIỀU CHỈNH VỀ PHẠM VI HỢP TÁC 2</h3>
            </div>
            <div class="modal-body">
                <div class="row justify-content-center">
                    <div class="col-md-3">
                        <input hidden readonly type="text" class="form-control" id="idx_ex_mou_edit_for_edit" placeholder="" name="idx_edit" value="no" />
                        <label style="color:red">*</label><label class="font-weight-bolder">Đối tác</label>&nbsp;
                        <select class="form-control" required id="partner_name_ex_mou_edit_for_edit">
                        </select>
                    </div>
                    <div class="col-md-9">
                        <label style="color:red">*</label><label class="font-weight-bolder">Phạm vi hợp tác</label>&nbsp;
                        <select class="form-control select2" required id="coop_scope_ex_mou_edit_for_edit" multiple="multiple" style="width:100% !important">
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer ">
                <button type="button" class="btn btn-sm btn-secondary px-6" data-dismiss="modal">Đóng</button>
                <button type="button" onclick="editExMOUTempForEdit()" class="btn btn-sm btn-light-primary px-6" data-dismiss="modal">Sửa</button>
            </div>
        </div>
    </div>
</div>

@*modal mou_partner_history*@
<div class="modal fade in" id="mou_partner_history" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header justify-content-center row">
                <h4 class="modal-title font-weight-bolder">LỊCH SỬ THỎA THUẬN HỢP TÁC</h4>
            </div>
            <div class="modal-body row">
                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                    <input class="form-control text-center" type="text" placeholder="Tên đối tác" autocomplete="off" id="partner_name_history" disabled />
                </div>
                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                    <input class="form-control text-center" type="text" placeholder="Mã hiệu" autocomplete="off" id="mou_id_history" disabled />
                </div>
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mt-3">
                    <table id="history-table" class="table table-bordered table-hover table-checkable">
                        <thead>
                            <tr>
                                <th class="text-center">STT</th>
                                <th class="text-center">Hoạt động</th>
                                <th class="text-center">Người thao tác</th>
                                <th class="text-center">Thời gian thao tác</th>
                            </tr>
                        </thead>
                        <tbody id="body_mou_history">
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-sm btn-secondary px-6" data-dismiss="modal">Đóng</button>
            </div>
        </div>
    </div>
</div>

@*modal add_partner_mou*@
<div class="modal fade in" id="add_partner_mou" aria-hidden="true" style="z-index: 8888">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header justify-content-center row">
                <h4 class="modal-title font-weight-bolder" id="add_partner_mou_title">THÊM ĐỐI TÁC TRONG BIÊN BẢN GHI NHỚ</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label style="color:red">*</label>
                        <label class="font-weight-bolder">Tên đối tác</label>
                        <label style="color:blue" class="float-right"><a href="#" onclick="checkPartnerAdd()">Kiểm tra</a></label>
                        @*<div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
                                <input type="text" class="form-control" id="partner_name_add" list="partnerList" onchange="preventAdd()" />
                            </div>*@
                        <input hidden readonly type="text" class="form-control" id="partner_id_add" placeholder="" name="" value="" />
                        <div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
                            <select class="form-control select-search" id="mou_partner_name_add" name="param" list="officeList" style="width:100% !important">
                                @foreach (var item in ViewBag.listPartnerMOUPartner)
                                {
                                    <option value="@item.partner_name">@item.partner_name</option>
                                }
                            </select>
                        </div>
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Quốc gia</label>
                        <input class="form-control " type="text" placeholder="Quốc gia" autocomplete="off" id="mou_partner_nation_add" />
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Website</label>
                        <input class="form-control" type="text" placeholder="Website" autocomplete="off" id="mou_partner_website_add" />
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Địa chỉ đối tác</label>
                        <input class="form-control " type="text" placeholder="Địa chỉ đối tác" autocomplete="off" id="mou_partner_address_add" />
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Đại diện</label>
                        <input class="form-control " type="text" placeholder="Đại diện" autocomplete="off" id="mou_partner_represent_add" />
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Email</label>
                        <input class="form-control " type="text" placeholder="Email" autocomplete="off" id="mou_partner_email_add" />
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Số điện thoại</label>
                        <input class="form-control " type="text" placeholder="Số điện thoại" autocomplete="off" id="mou_partner_phone_add" />
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label style="color:red">*</label>
                        <label class="font-weight-bolder">Ngày ký kết</label>
                        <div class="input-group date kt_datetimepicker_3" id="kt_datetimepicker_sign_date_add" data-target-input="nearest">
                            <input type="text" class="form-control datetimepicker-input" id="mou_sign_date_partner_add" data-target="#kt_datetimepicker_sign_date_add" />
                            <div class="input-group-append" data-target="#kt_datetimepicker_sign_date_add" data-toggle="datetimepicker">
                                <span class="input-group-text">
                                    <i class="ki ki-calendar"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label style="color:red">*</label>
                        <label class="font-weight-bolder">Lĩnh vực</label>
                        <label style="color:blue" class="float-right"><a href="#">Quản lý</a></label>
                        <div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
                            <select class="form-control select2" id="mou_partner_specialization_add" name="param" multiple="multiple" style="width:100% !important">
                                @foreach (var item in ViewBag.listSpeMOUPartner)
                                {
                                    <option value="@item.specialization_id">@item.specialization_name</option>
                                }
                            </select>
                        </div>
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label style="color:red">*</label>
                        <label class="font-weight-bolder">Phạm vi hợp tác</label>
                        <label style="color:blue" class="float-right"><a href="#">Quản lý</a></label>
                        <div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
                            <select class="form-control select2" id="mou_partner_scope_add" name="param" multiple="multiple" style="width:100% !important">
                                @foreach (var item in ViewBag.listScopesMOUPartner)
                                {
                                    <option value="@item.scope_id">@item.scope_abbreviation</option>
                                }
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-sm btn-secondary" data-dismiss="modal">Đóng</button>
                <button id="add_mou_partner_button" type="button" class="btn btn-sm btn-light-primary" data-dismiss="modal" onclick="addMOUPartner()" disabled>Thêm</button>
            </div>
        </div>
    </div>
</div>

@*modal edit_partner_mou*@
<div class="modal fade in" id="edit_partner_mou" aria-hidden="true" style="z-index: 8888">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header justify-content-center row">
                <h4 class="modal-title font-weight-bolder" id="add_partner_mou_title">SỬA ĐỐI TÁC TRONG BIÊN BẢN GHI NHỚ</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label style="color:red">*</label>
                        <label class="font-weight-bolder">Tên đối tác</label>
                        <label style="color:blue" class="float-right"><a href="#" onclick="checkPartnerEdit()">Kiểm tra</a></label>
                        @*<div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
                                <input type="text" class="form-control" id="partner_name_add" list="partnerList" onchange="preventAdd()" />
                            </div>*@
                        <input hidden readonly type="text" class="form-control" id="partner_id_edit" placeholder="" name="" value="" />
                        <div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
                            <select class="form-control select-search" id="mou_partner_name_edit" name="param" style="width:100% !important">
                            </select>
                        </div>
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Quốc gia</label>
                        <input class="form-control " type="text" placeholder="Quốc gia" autocomplete="off" id="mou_partner_nation_edit" />
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Website</label>
                        <input class="form-control" type="text" placeholder="Website" autocomplete="off" id="mou_partner_website_edit" />
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Địa chỉ đối tác</label>
                        <input class="form-control " type="text" placeholder="Địa chỉ đối tác" autocomplete="off" id="mou_partner_address_edit" />
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Đại diện</label>
                        <input class="form-control " type="text" placeholder="Đại diện" autocomplete="off" id="mou_partner_represent_edit" />
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Email</label>
                        <input class="form-control " type="text" placeholder="Email" autocomplete="off" id="mou_partner_email_edit" />
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Số điện thoại</label>
                        <input class="form-control " type="text" placeholder="Số điện thoại" autocomplete="off" id="mou_partner_phone_edit" />
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label style="color:red">*</label>
                        <label class="font-weight-bolder">Ngày ký kết</label>
                        <div class="input-group date kt_datetimepicker_3" id="kt_datetimepicker_sign_date_add" data-target-input="nearest">
                            <input type="text" class="form-control datetimepicker-input" id="mou_sign_date_partner_edit" data-target="#kt_datetimepicker_sign_date_add" />
                            <div class="input-group-append" data-target="#kt_datetimepicker_sign_date_add" data-toggle="datetimepicker">
                                <span class="input-group-text">
                                    <i class="ki ki-calendar"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label style="color:red">*</label>
                        <label class="font-weight-bolder">Lĩnh vực</label>
                        <label style="color:blue" class="float-right"><a href="#">Quản lý</a></label>
                        <div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
                            <select class="form-control select2" id="mou_partner_specialization_edit" name="param" multiple="multiple" style="width:100% !important">
                            </select>
                        </div>
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label style="color:red">*</label>
                        <label class="font-weight-bolder">Phạm vi hợp tác</label>
                        <label style="color:blue" class="float-right"><a href="#">Quản lý</a></label>
                        <div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
                            <select class="form-control select2" id="mou_partner_scope_edit" name="param" multiple="multiple" style="width:100% !important">
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-sm btn-secondary" data-dismiss="modal">Đóng</button>
                <button id="edit_mou_partner_button" type="button" class="btn btn-sm btn-light-primary" data-dismiss="modal" onclick="editMOUPartner()" disabled>Sửa</button>
            </div>
        </div>
    </div>
</div>

@*modal add_partner_moa*@
<div class="modal fade in" id="add_partner_moa" aria-hidden="true" style="z-index: 8888">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header justify-content-center row">
                <h4 class="modal-title font-weight-bolder" id="add_partner_moa_title">THÊM ĐỐI TÁC TRONG BIÊN BẢN THỎA THUẬN</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label style="color:red">*</label>
                        <label class="font-weight-bolder">Tên đối tác</label>
                        <label style="color:blue" class="float-right"><a href="#" onclick="checkPartnerAddMOA()" onchange="preventAddMOA()">Kiểm tra</a></label>
                        @*<div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
                                <input type="text" class="form-control" id="partner_name_add" list="partnerList" onchange="preventAdd()" />
                            </div>*@
                        <input hidden readonly type="text" class="form-control" id="moa_partner_id_add" placeholder="" name="" value="" />
                        <div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
                            <select class="form-control select-search" id="moa_partner_name_add" name="param" list="officeList" style="width:100% !important">
                                @foreach (var item in ViewBag.listPartnersMOA)
                                {
                                    <option value="@item.partner_name">@item.partner_name</option>
                                }
                            </select>
                        </div>
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Quốc gia</label>
                        <input class="form-control " type="text" placeholder="Quốc gia" autocomplete="off" id="moa_partner_nation_add" disabled/>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Website</label>
                        <input class="form-control" type="text" placeholder="Website" autocomplete="off" id="moa_partner_website_add" disabled/>
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Địa chỉ đối tác</label>
                        <input class="form-control " type="text" placeholder="Địa chỉ đối tác" autocomplete="off" id="moa_partner_address_add" disabled/>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Đại diện</label>
                        <input class="form-control " type="text" placeholder="Đại diện" autocomplete="off" id="moa_partner_represent_add" disabled/>
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Email</label>
                        <input class="form-control " type="text" placeholder="Email" autocomplete="off" id="moa_partner_email_add" disabled/>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Số điện thoại</label>
                        <input class="form-control " type="text" placeholder="Số điện thoại" autocomplete="off" id="moa_partner_phone_add" disabled/>
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label style="color:red">*</label>
                        <label class="font-weight-bolder">Ngày ký kết</label>
                        <div class="input-group date kt_datetimepicker_3" id="kt_datetimepicker_moa_sign_date_add" data-target-input="nearest">
                            <input type="text" class="form-control datetimepicker-input" id="moa_sign_date_partner_add" data-target="#kt_datetimepicker_moa_sign_date_add" />
                            <div class="input-group-append" data-target="#kt_datetimepicker_moa_sign_date_add" data-toggle="datetimepicker">
                                <span class="input-group-text">
                                    <i class="ki ki-calendar"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label style="color:red">*</label>
                        <label class="font-weight-bolder">Lĩnh vực</label>
                        <label style="color:blue" class="float-right"><a href="#">Quản lý</a></label>
                        <div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
                            <input class="form-control " type="text" id="moa_partner_specialization_add" disabled value=""/>
                        </div>
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label style="color:red">*</label>
                        <label class="font-weight-bolder">Phạm vi hợp tác</label>
                        <label style="color:blue" class="float-right"><a href="#">Quản lý</a></label>
                        <div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
                            <select class="form-control select2" id="moa_partner_scope_add" name="param" multiple="multiple" style="width:100% !important">
                                
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-sm btn-secondary" data-dismiss="modal">Đóng</button>
                <button id="add_moa_partner_button" type="button" class="btn btn-sm btn-light-primary" data-dismiss="modal" onclick="addToTempMOA()" disabled>Thêm</button>
            </div>
        </div>
    </div>
</div>

@*modal edit_partner_moa*@
<div class="modal fade in" id="edit_partner_moa" aria-hidden="true" style="z-index: 8888">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header justify-content-center row">
                <h4 class="modal-title font-weight-bolder" id="edit_partner_moa_title">SỬA ĐỐI TÁC TRONG BIÊN BẢN GHI NHỚ</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label style="color:red">*</label>
                        <label class="font-weight-bolder">Tên đối tác</label>
                        <label style="color:blue" class="float-right"><a href="#" onclick="checkPartnerEditMOA()">Kiểm tra</a></label>
                        @*<div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
            <input type="text" class="form-control" id="partner_name_add" list="partnerList" onchange="preventAdd()" />
        </div>*@
                        <input hidden readonly type="text" class="form-control" id="partner_id_moa_edit" placeholder="" name="" value="" />
                        <input hidden readonly type="text" class="form-control" id="idx_moa_edit" placeholder="" name="idx_edit" value="no" />
                        <div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
                            <select class="form-control select-search" id="moa_partner_name_edit" name="param" style="width:100% !important">
                            </select>
                        </div>
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Quốc gia</label>
                        <input class="form-control " type="text" placeholder="Quốc gia" autocomplete="off" id="moa_partner_nation_edit" disabled/>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Website</label>
                        <input class="form-control" type="text" placeholder="Website" autocomplete="off" id="moa_partner_website_edit" disabled/>
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Địa chỉ đối tác</label>
                        <input class="form-control " type="text" placeholder="Địa chỉ đối tác" autocomplete="off" id="moa_partner_address_edit" disabled/>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Đại diện</label>
                        <input class="form-control " type="text" placeholder="Đại diện" autocomplete="off" id="moa_partner_represent_edit" disabled/>
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Email</label>
                        <input class="form-control " type="text" placeholder="Email" autocomplete="off" id="moa_partner_email_edit" disabled/>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label class="font-weight-bolder">Số điện thoại</label>
                        <input class="form-control " type="text" placeholder="Số điện thoại" autocomplete="off" id="moa_partner_phone_edit" disabled/>
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label style="color:red">*</label>
                        <label class="font-weight-bolder">Ngày ký kết</label>
                        <div class="input-group date kt_datetimepicker_3" id="kt_datetimepicker_moa_sign_date_edit" data-target-input="nearest">
                            <input type="text" class="form-control datetimepicker-input" id="moa_sign_date_partner_edit" data-target="#kt_datetimepicker_moa_sign_date_edit" />
                            <div class="input-group-append" data-target="#kt_datetimepicker_moa_sign_date_edit" data-toggle="datetimepicker">
                                <span class="input-group-text">
                                    <i class="ki ki-calendar"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label style="color:red">*</label>
                        <label class="font-weight-bolder">Lĩnh vực</label>
                        <label style="color:blue" class="float-right"><a href="#">Quản lý</a></label>
                        <div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
                            <input class="form-control " type="text" id="moa_partner_specialization_edit" disabled value="" />
                        </div>
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                        <label style="color:red">*</label>
                        <label class="font-weight-bolder">Phạm vi hợp tác</label>
                        <label style="color:blue" class="float-right"><a href="#">Quản lý</a></label>
                        <div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
                            <select class="form-control select2" id="moa_partner_scope_edit" name="param" multiple="multiple" style="width:100% !important">
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-sm btn-secondary" data-dismiss="modal">Đóng</button>
                <button id="edit_moa_partner_button" type="button" class="btn btn-sm btn-light-primary" data-dismiss="modal" onclick="editTempMOA()" disabled>Sửa</button>
            </div>
        </div>
    </div>
</div>

@*modal add_moa*@
<div class="modal fade in" id="add_moa_modal" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="modal-title font-weight-bolder" id="e">THÊM BIÊN BẢN THỎA THUẬN</h3>
            </div>
            <div class="justify-content-center">
                <div class="custom-container">
                    <ul class="progressbar">
                        <li class="active"></li>
                        <li></li>
                    </ul>
                </div>
            </div>
            <div id='step-1' class="modal-body">
                <div class="row justify-content-center">
                    <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5">
                        <label style="color:red">*</label>
                        <label class="font-weight-bolder">Số hiệu</label>
                        <label style="font-style: italic;">
                        </label>
                        <input class="form-control" type="text" placeholder="Số hiệu" autocomplete="off" required id="moa_code" value="@ViewBag.newMOACode" />
                    </div>
                    <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5">
                        <label class="font-weight-bolder">Đơn vị - Cơ sở kí kết</label>&nbsp;
                        <div class="d-flex align-items-center col-xl-12 col-lg-12 px-0">
                            <input class="form-control" type="text" disabled value="" id="facility_moa" />
                        </div>
                    </div>
                </div>
                <div class="row mt-3 justify-content-center">
                    <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5">
                        <label class="font-weight-bolder">Thời gian kí kết</label>&nbsp;
                        <label style="font-style: italic;">
                            (Cập nhật theo thời gian kí kết)
                        </label>
                        <div class="input-group date kt_datetimepicker_3" id="kt_datetimepicker_sign_date_moa" data-target-input="nearest">
                            <input disabled type="text" class="form-control datetimepicker-input" placeholder="Thời gian kí kết" id="sign_date_moa" data-target="#kt_datetimepicker_sign_date_moa" />
                            <div class="input-group-append" data-target="#kt_datetimepicker_sign_date_moa" data-toggle="datetimepicker">
                                <span class="input-group-text">
                                    <i class="ki ki-calendar"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-5 col-lg-5 col-md-5 col-sm-5">
                        <label class="font-weight-bolder">Thời gian hết hạn</label>&nbsp;
                        <label style="font-style: italic;">
                        </label>
                        <div class="input-group date kt_datetimepicker_3" id="kt_datetimepicker_end_date_moa" data-target-input="nearest">
                            <input type="text" class="form-control datetimepicker-input" placeholder="Thời gian hết hạn" id="end_date_moa" data-target="#kt_datetimepicker_end_date_moa" />
                            <div class="input-group-append" data-target="#kt_datetimepicker_end_date_moa" data-toggle="datetimepicker">
                                <span class="input-group-text">
                                    <i class="ki ki-calendar"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt-3 justify-content-center">
                    <div class="col-xl-3 col-lg-3 col-md-4 col-sm-4">
                        <label style="color:red">*</label>
                        <label class="font-weight-bolder">Trạng thái</label>&nbsp;
                        <select class="form-control" required id="status_moa">
                            <option value="1">Inactive</option>
                            <option value="2">Active</option>
                        </select>
                    </div>
                    <div class="col-xl-7 col-lg-7 col-md-8 col-sm-8">
                        <label class="font-weight-bolder">Ghi chú</label>&nbsp;
                        <input class="form-control" type="text" placeholder="Ghi chú" autocomplete="off" required id="note_moa" />
                    </div>
                </div>
                <div class="row mt-3 justify-content-center">
                    <div class="col-xl-10 col-lg-10 col-md-12 col-sm-12">
                        <label class="font-weight-bolder">Phạm vi hợp tác chính</label>&nbsp;
                        <label style="font-style: italic;">
                            (Cập nhật theo pham vi hợp tác của các đối tác kí kết)
                        </label>
                        <input disabled class="form-control" type="text" placeholder="Phạm vi hợp tác" autocomplete="off" required id="coop_scope_moa" />
                    </div>
                </div>
                <div class="row mt-3 justify-content-center">
                    <div class="col-xl-10 col-lg-10 col-md-12 col-sm-12">
                        <label class="font-weight-bolder">Bản mềm</label>&nbsp;
                        <label style="font-style: italic;">(Tối đa 1MB và 5 tệp tin)</label>
                        <div class="uppy row" id="moa_upload">
                            <div class="uppy-wrapper col-3"></div>
                            <div class="uppy-list col-7"></div>
                            <div class="uppy-status"></div>
                            <div class="uppy-informer uppy-informer-min"></div>
                        </div>
                    </div>
                </div>
                <div class="row mt-3 justify-content-center">
                    <div class="col-xl-10 col-lg-1 col-md-12 col-sm-12">
                        <label class="font-weight-bolder">Lưu ý</label>&nbsp;
                        <textarea class="form-control " id="moa_area" rows="3"></textarea>
                    </div>
                </div>
            </div>
            <div id='step-2' class="modal-body" style="display:none">
                <div class="col-lg-3 col-xl-3 col-md-3 col-sm-12 mb-3">
                    <div class="row align-items-center">
                        <a href="#add_partner_moa" data-toggle="modal" id="" class="btn btn-sm btn-light-primary px-6 font-weight-bold">Thêm</a>
                    </div>
                </div>
                <table class="table table-bordered table-hover table-checkable"
                       id="moa-partner-table">
                    <tr>
                        <th class="text-center" rowspan="2">STT</th>
                        <th class="text-center" rowspan="2">Tên đối tác</th>
                        <th class="text-center" colspan="3">Người đại diện</th>
                        <th class="text-center" rowspan="2"></th>
                    </tr>
                    <tr>
                        <th>Họ và tên</th>
                        <th>Điện thoại</th>
                        <th>Email</th>
                    </tr>
                    @*<tr>
                        <td>1</td>
                        <td>Bunkyo University</td>
                        <td>Toshie Miyatake</td>
                        <td>+81 48 974 8811</td>
                        <td>kiec@stf.bunkyou.ac.jp</td>
                        <td nowrap="nowrap">
                            <a onclick="" href="#add_partner_moa" data-toggle="modal" class="btn btn-sm btn-light-primary px-6 font-weight-bold" style="margin-right: 10px;">Sửa</a>
                            <a onclick="confirm_delete(12)" class="btn btn-sm btn-light-danger px-6 font-weight-bold" data-toggle="modal">Xóa</a>
                        </td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>FPT Greenwich</td>
                        <td>Cuong Minh Tran</td>
                        <td>+84 12 345 2345</td>
                        <td>cuong@fptgr.edu.vn</td>
                        <td nowrap="nowrap">
                            <a onclick="" href="#add_partner_moa" data-toggle="modal" class="btn btn-sm btn-light-primary px-6 font-weight-bold" style="margin-right: 10px;">Sửa</a>
                            <a onclick="confirm_delete(12)" class="btn btn-sm btn-light-danger px-6 font-weight-bold" data-toggle="modal">Xóa</a>
                        </td>
                    </tr>*@
                </table>
            </div>
            <div class="modal-footer">
                <button id="step-1-close-btn" type="button" class="btn btn-sm btn-secondary px-6" data-dismiss="modal">Đóng</button>
                <button id='step-1-button' type="button" class="btn btn-sm btn-primary px-6" onclick="nextStep()">Tiếp</button>
                <button id='step-2-backbutton' type="button" class="btn btn-sm btn-secondary px-6" onclick="backToStep()" style="display:none">Quay về</button>
                <button id='step-2-button' type="button" class="btn btn-sm btn-primary px-6" onclick="doneStep()" data-dismiss="modal" style="display:none">Hoàn thành</button>
            </div>
        </div>
    </div>
</div>


@section scripts{
    <link href="~/Content/assets/plugins/custom/datatables/datatables.bundle.css" rel="stylesheet" />
    <script src="~/Content/assets/plugins/custom/datatables/datatables.bundle.js"></script>

    @*delete alert*@
    <script>
         //funtion delete
        function confirm_delete(id) {
        //function confirm_delete(id, action, controller) {
            var link = '@Url.Action("action", "controller")'
            link = link.replace("action", "Delete_MOU");
            link = link.replace("controller", "MOU");
            Swal.fire({
                title: "Are you sure?",
                text: "You won't be able to revert this!",
                icon: "warning",
                showCancelButton: true,
                confirmButtonText: "Yes, delete it!",
                cancelButtonText: "No, cancel!",
                reverseButtons: true
            }).then(function (result) {
                if (result.value) {
                    $.ajax({
                        url: link,
                        data: { mou_id : id },
                        success: function (data) {
                            if (data = "") {
                                Swal.fire("Good job!", "You clicked the button!", "error");
                            } else {
                                Swal.fire("Deleted!", "Your file has been deleted.", "success")
                            }
                        },
                        error: function (data) {
                            Swal.fire("Good job!", "You clicked the button!", "error");
                        },
                    })
                }
            })
        };
    </script>

    @*datatable*@
    <script>
        //datepicker functions
        $(document).ready(function () {
            //split card
            //overflow
            $('.header-modify').css('padding', '13px');
        });

        //table tab 1
        //$("#collaboration_update_table").DataTable({
        //    oLanguage: {
        //        oPaginate: {
        //            sPrevious: "Trang trước",
        //            sNext: "Trang sau"
        //        },
        //        sEmptyTable: "Không có dữ liệu",
        //        sInfo: "Đang hiển thị từ _START_ đến _END_ của _TOTAL_ bản ghi",
        //    },
        //    searching: false,
        //    lengthChange: false,
        //    columnDefs: [
        //        {
        //            targets: 5,
        //            width: '75px',
        //            render: function (data, type, full, meta) {
        //                return ''
        //                    + '<a href="#add_status" data-toggle="modal"><span class="svg-icon svg-icon-dark svg-icon-md"><!--begin::Svg Icon | path:/var/www/preview.keenthemes.com/metronic/releases/2021-02-01-052524/theme/html/demo1/dist/../src/media/svg/icons/Design/Edit.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M7.71 3.5L1.15 15l3.43 6l6.55-11.5M9.73 15L6.3 21h13.12l3.43-6m-.57-1L15.42 2H8.57l6.86 12h6.85z" fill="#626262"/></svg><!--end::Svg Icon--></span></a>';
        //            },
        //        },
        //        {
        //            targets: -1,
        //            title: '',
        //            orderable: false,
        //            width: '125px',
        //            render: function (data, type, full, meta) {
        //                return '<a class="btn btn-sm btn-light-primary px-6" style="margin-right: 10px;">Sửa</a><a onclick="confirm_delete(12)" class="btn btn-sm btn-light-danger px-6" data-toggle="modal">Xóa</a>'
        //            }
        //        }
        //    ]
        //});

        //table tab 2
        //$("#partner_table").DataTable({
        //    oLanguage: {
        //        oPaginate: {
        //            sPrevious: "Trang trước",
        //            sNext: "Trang sau"
        //        },
        //        sEmptyTable: "Không có dữ liệu cxzzxc",
        //        sInfo: "Đang hiển thị từ _START_ đến _END_ của _TOTAL_ bản ghi",

        //    },
        //    searching: false,
        //    lengthChange: false,
        //    initComplete: function () {
        //        $('#partner_table').parent().css('overflow-x', 'auto');
        //        $('#partner_table').parent().removeClass();
        //    },
        //    columnDefs: [
        //        {
        //            targets: 4,
        //            orderable: false,
        //            width: '75px',
        //            render: function (data, type, full, meta) {
        //                return '<a href="#"><span class="svg-icon svg-icon-dark svg-icon-md"><!--begin::Svg Icon | path:/var/www/preview.keenthemes.com/metronic/releases/2021-02-01-052524/theme/html/demo1/dist/../src/media/svg/icons/Design/Edit.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none"><path d="M13.544 10.456a4.368 4.368 0 0 0-6.176 0l-3.089 3.088a4.367 4.367 0 1 0 6.177 6.177L12 18.177m-1.544-4.633a4.368 4.368 0 0 0 6.177 0l3.088-3.088a4.368 4.368 0 0 0-6.177-6.177L12 5.823" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></g></svg><!--end::Svg Icon--></span></a>';
        //            },
        //        },
        //        {
        //            targets: -1,
        //            title: 'Hành động',
        //            orderable: false,
        //            width: '125px',
        //            render: function (data, type, full, meta) {
        //                return '<a onclick="show_status_history(12)" class="show-status-history" href="#mou_partner_history" data-toggle="modal"><span class="svg-icon svg-icon-dark svg-icon-sm"><!--begin::Svg Icon | path:/var/www/preview.keenthemes.com/metronic/releases/2021-02-01-052524/theme/html/demo1/dist/../src/media/svg/icons/Code/Time-schedule.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 512 512"><path d="M504 255.531c.253 136.64-111.18 248.372-247.82 248.468c-59.015.042-113.223-20.53-155.822-54.911c-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184c0-101.705-82.311-184-184-184c-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z" fill="black"/></svg><!--end::Svg Icon--></span></a> '
        //                    + '<a onclick="show_data_partner_detail(13)" href="#add_partner_mou" data-toggle="modal" class="btn btn-sm btn-light-primary update_partner_mou px-6" style="margin-right: 10px;">Sửa</a><a onclick="confirm_delete(12)" class="btn btn-sm btn-light-danger px-6" data-toggle="modal">Xóa</a>';
        //            }
        //        },
        //        {
        //            targets: [-1, 0, 2, 3, 4, 9],
        //            className: 'text-center',
        //        },
        //        {
        //            targets: [-1, ],
        //            className: 'text-nowrap',
        //        }

        //    ]
        //})



        //table tab 3
        //$("#moa_table").DataTable({
        //    oLanguage: {
        //        oPaginate: {
        //            sPrevious: "Trang trước",
        //            sNext: "Trang sau"
        //        },
        //        sEmptyTable: "Không có dữ liệu",
        //        sInfo: "Đang hiển thị từ _START_ đến _END_ của _TOTAL_ bản ghi",

        //    },
        //    searching: false,
        //    lengthChange: false,
        //    columnDefs: [
        //        {
        //            targets: 3,
        //            orderable: false,
        //            render: function (data, type, full, meta) {
        //                return '<a href="#" data-toggle="modal"><span class="svg-icon svg-icon-dark svg-icon-md"><!--begin::Svg Icon | path:/var/www/preview.keenthemes.com/metronic/releases/2021-02-01-052524/theme/html/demo1/dist/../src/media/svg/icons/Design/Edit.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M7.71 3.5L1.15 15l3.43 6l6.55-11.5M9.73 15L6.3 21h13.12l3.43-6m-.57-1L15.42 2H8.57l6.86 12h6.85z" fill="#626262"/></svg><!--end::Svg Icon--></span></a>';
        //            }
        //        },
        //        {
        //            targets: 8,
        //            width: '75px',
        //            render: function (data, type, full, meta) {
        //                var status = {
        //                    1: {
        //                        'title': 'Active',
        //                        'class': 'label-light-danger'
        //                    },
        //                    2: {
        //                        'title': 'Inactive',
        //                        'class': 'label-light-success'
        //                    }
        //                };
        //                if (typeof status[data] === 'undefined') {
        //                    return data;
        //                }
        //                return '<span class="label label-lg font-weight-bold ' + status[data].class + ' label-inline">' + status[data].title + '</span> ';
        //            },
        //        },
        //        {
        //            targets: -1,
        //            title: 'Hành động',
        //            orderable: false,
        //            width: '125px',
        //            render: function (data, type, full, meta) {
        //                return '<a onclick="" href="#" data-toggle="modal" class="btn btn-sm btn-light-primary px-6" style="margin-right: 10px;">Sửa</a><a onclick="confirm_delete(12)" class="btn btn-sm btn-light-danger px-6" data-toggle="modal">Xóa</a>';
        //            }
        //        }
        //    ]
        //});

        //modal tab 2
        @*function show_status_history(id){
            $.ajax({
                url: '@Url.Action("Get_MOU_History", "PartnerMOU")',
                data: { 'id': id },
                success: function (data) {
                    if (data = "") {
                        toastr.error("Có lỗi xảy ra");
                    } else {
                        var temp = '';
                        var partner_name_temp = 'Bunkyou University';
                        var mou_id_temp = '2021/01';
                        for (i = 0; i < 3; i++) {
                            temp += '<tr><td  class="text-center">' + i + 1 + '</td><td class="text-center">Ký kết biên bản ghi nhớ</td><td class="text-center">Lê Phương Anh</td><td class="text-center">18/03/2020 13:01:23</td></tr>';
                        }
                        $('#body_mou_history').html(temp);
                        $('#partner_name').val(partner_name_temp);
                        $('#mou_id').val(mou_id_temp);
                    }
                },
            });
        };*@

        //modal tab 2
        $('#add_partner_mou_btn').click(function () {
            $('#add_partner_mou_title').text('THÊM ĐỐI TÁC TRONG BIÊN BẢN GHI NHỚ');
        })

        //modal tab 3
        $('#add_partner_moa_btn').click(function () {
            $('#add_partner_mou_title').text('THÊM ĐỐI TÁC TRONG BIÊN BẢN THỎA THUẬN');
        })

        //modal tab 2
        function show_data_partner_detail(id) {
            $('#add_partner_mou_title').text('SỬA ĐỐI TÁC TRONG BIÊN BẢN GHI NHỚ');
            $.ajax({
                url: '@Url.Action("Get_Data_Partner_Detail", "PartnerMOU")',
                data: { 'id': id },
                success: function (data) {
                    if (data = "") {
                        toastr.error("Có lỗi xảy ra");
                    } else {
                        //toastr.success("Lmao");
                    }
                },
            });
        };

        //modal tab 3
        function show_data_partner_detail_moa_screen(id) {
            $('#add_partner_mou_title').text('SỬA ĐỐI TÁC TRONG BIÊN BẢN THỎA THUẬN');
            $.ajax({
                url: '@Url.Action("Get_Data_Partner_Detail", "MOU")',
                data: { 'id': id },
                success: function (data) {
                    if (data = "") {
                        toastr.error("Có lỗi xảy ra");
                    } else {
                        //toastr.success("Lmao");
                    }
                },
            });
        };

    </script>
    @*dropdown list*@
    <script>
        //jquery for dropdown
        $('#search_nation').select2({
            placeholder: 'Quốc gia',
            allowClear: true,
        })

        $('#search_specialization').select2({
            placeholder: 'Lĩnh vực',
            allowClear: true,
        })
        $('#coop_scope_ex_mou_add').select2({
            placeholder: 'Lĩnh vực',
            allowClear: true,
        })
        $('#coop_scope_ex_mou_edit').select2({
            placeholder: 'Lĩnh vực',
            allowClear: true,
        })
        $('#coop_scope_ex_mou_edit_for_edit').select2({
            placeholder: 'Lĩnh vực',
            allowClear: true,
        })
        $('#coop_scope_ex_mou_add_for_edit').select2({
            placeholder: 'Lĩnh vực',
            allowClear: true,
        })
        $('#mou_partner_specialization_add').select2({
            placeholder: 'Lĩnh vực',
            allowClear: true,
        })
        $('#moa_partner_scope_add').select2({
            placeholder: 'Phạm vi hợp tác',
            allowClear: true,
        })
        $('#moa_partner_scope_edit').select2({
            placeholder: 'Phạm vi hợp tác',
            allowClear: true,
        })
        $('#mou_partner_scope_add').select2({
            placeholder: 'Phạm vi hợp tác',
            allowClear: true,
        })
        $('#mou_partner_specialization_edit').select2({
            placeholder: 'Lĩnh vực',
            allowClear: true,
        })
        $('#mou_partner_scope_edit').select2({
            placeholder: 'Phạm vi hợp tác',
            allowClear: true,
        })

        $('#facility').select2({
            placeholder: 'Đơn vị - Cơ sở kí kết',
            allowClear: true,
        })
        $('#partner_name_form').select2({
            placeholder: 'Tên đối tác',
            allowClear: true,
        })
        $('#specialization').select2({
            placeholder: 'Lĩnh vực',
            allowClear: true,
        })
        $('#coop_scope_modal').select2({
            placeholder: 'Phạm vi hợp tác',
            allowClear: true,
        })
        $('#facility_moa').select2({
            placeholder: 'Đơn vị - Cơ sở kí kết',
            allowClear: true,
        })

        //datepicker
        var KTBootstrapDatetimepicker = function () {
            var baseDemos = function () {
                $('.kt_datetimepicker_3').datetimepicker({
                    format: 'DD/MM/yyyy'
                });

            }
            return {
                // Public functions
                init: function () {
                    baseDemos();
                }
            };
        }();

        jQuery(document).ready(function () {
            KTBootstrapDatetimepicker.init();
        });
    </script>
    <script>
        var MultipleDropDownDemo = function () {
            var demo5 = function () {
                // Init autocompletes
                var toEl = document.getElementById('multiple-dropdown');
                var tagifyTo = new Tagify(toEl, {
                    delimiters: ", ", // add new tags when a comma or a space character is entered
                    maxTags: 10,
                    blacklist: ["fuck", "shit", "pussy"],
                    keepInvalidTags: false, // do not remove invalid tags (but keep them marked as invalid)
                    whitelist: [
                        {
                            value: 'Thắng',
                            email: '',
                            initials: '',
                            initialsState: '',
                            pic: '',
                            class: 'tagify__tag--primary'
                        }, {
                            value: 'Yêu',
                            email: '',
                            initials: 'SS',
                            initialsState: 'warning',
                            pic: ''
                        }, {
                            value: 'Nguyên',
                            email: '',
                            initials: '',
                            initialsState: '',
                            pic: ''
                        }],
                    templates: {
                        dropdownItem: function (tagData) {
                            try {
                                var html = '';
                                html += '<div class="tagify__dropdown__item">';
                                html += '   <div class="d-flex align-items-center">';
                                html += '       <span class="symbol sumbol-' + (tagData.initialsState ? tagData.initialsState : '') + ' mr-2">';
                                html += '           <span class="symbol-label" style="background-image: url(\'' + (tagData.pic ? tagData.pic : '') + '\')">' + (tagData.initials ? tagData.initials : '') + '</span>';
                                html += '</span > ';
                                html += '       <div class="d-flex flex-column">';
                                html += '           <a href="#" class="text-dark-75 text-hover-primary font-weight-bold">' + (tagData.value ? tagData.value : '') + '</a>';
                                html += '           <span class="text-muted font-weight-bold">' + (tagData.email ? tagData.email : '') + '</span>';
                                html += ' </div > ';
                                html += ' </div > ';
                                html += '</div > ';
                                return html;
                            } catch (err) { }
                        }
                    },
                    transformTag: function (tagData) {
                        tagData.class = 'tagify__tag tagify__tag--primary';
                    },
                    dropdown: {
                        classname: "color-blue",
                        enabled: 0,
                        maxItems: 5,
                        closeOnSelect: true,
                    }
                });
            }

            return {
                // public functions
                init: function () {
                    demo5();
                    $(".tagify__input").keydown(function (e) {
                        e.preventDefault()
                    })
                }
            };
        }();
        jQuery(document).ready(function () {
            MultipleDropDownDemo.init();
        });
    </script>
    @*wizard*@
    <script>
        var list = document.getElementsByClassName("progressbar")[0];
        itemList = list.getElementsByTagName("li");

        var div_step1 = document.getElementById("step-1");
        var div_step2 = document.getElementById("step-2");
        var button_step1 = document.getElementById("step-1-button");
        var step1_close_btn = document.getElementById("step-1-close-btn");
        var button_step2 = document.getElementById("step-2-button");
        var backbutton_step2 = document.getElementById("step-2-backbutton");

        function toggleNextStep() {
            itemList[0].classList.remove("active");
            itemList[0].classList.add("done");
            itemList[1].classList.add("active");
            div_step1.style.display = "none";
            button_step1.style.display = "none";
            step1_close_btn.style.display = "none";
            div_step2.style.display = "block";
            button_step2.style.display = "block";
            backbutton_step2.style.display = "block";
        }

        function toggleBackStep() {
            itemList[0].classList.add("active");
            itemList[0].classList.remove("done");
            itemList[1].classList.remove("active");
            div_step1.style.display = "block";
            button_step1.style.display = "block";
            step1_close_btn.style.display = "block";
            div_step2.style.display = "none";
            button_step2.style.display = "none";
            backbutton_step2.style.display = "none";
        }

    </script>
    @*upload file*@
    <script src="~/Content/assets/plugins/custom/uppy/uppy.bundle.js?v=7.0.6"></script>
    <script>
        "use strict";

        // Class definition
        var KTUppy = function () {
            const Tus = Uppy.Tus;
            const ProgressBar = Uppy.ProgressBar;
            const StatusBar = Uppy.StatusBar;
            const FileInput = Uppy.FileInput;
            const Informer = Uppy.Informer;

            // to get uppy companions working, please refer to the official documentation here: https://uppy.io/docs/companion/
            const Dashboard = Uppy.Dashboard;
            const Dropbox = Uppy.Dropbox;
            const GoogleDrive = Uppy.GoogleDrive;
            const Instagram = Uppy.Instagram;
            const Webcam = Uppy.Webcam;

            // Private functions

            var initUppy5 = function (data) {
                // Uppy variables
                // For more info refer: https://uppy.io/
                var elemId = data;
                var id = '#' + elemId;
                var $statusBar = $(id + ' .uppy-status');
                var $uploadedList = $(id + ' .uppy-list');
                var timeout;

                var uppyMin = Uppy.Core({
                    debug: true,
                    autoProceed: true,
                    showProgressDetails: true,
                    restrictions: {
                        maxFileSize: 1000000, // 1mb
                        maxNumberOfFiles: 5,
                        minNumberOfFiles: 1
                    }
                });

                uppyMin.use(FileInput, { target: id + ' .uppy-wrapper', pretty: false });
                uppyMin.use(Informer, { target: id + ' .uppy-informer' });

                // demo file upload server
                uppyMin.use(Tus, { endpoint: 'https://master.tus.io/files/' });
                uppyMin.use(StatusBar, {
                    target: id + ' .uppy-status',
                    hideUploadButton: true,
                    hideAfterFinish: false
                });

                $(id + ' .uppy-FileInput-input').addClass('uppy-input-control').attr('id', elemId + '_input_control');
                $(id + ' .uppy-FileInput-container').append('<label class="uppy-input-label btn btn-light-primary btn-sm btn-bold" for="' + (elemId + '_input_control') + '">Attach files</label>');

                var $fileLabel = $(id + ' .uppy-input-label');

                uppyMin.on('upload', function (data) {
                    $fileLabel.text("Uploading...");
                    $statusBar.addClass('uppy-status-ongoing');
                    $statusBar.removeClass('uppy-status-hidden');
                    clearTimeout(timeout);
                });

                uppyMin.on('complete', function (file) {
                    $.each(file.successful, function (index, value) {
                        var sizeLabel = "bytes";
                        var filesize = value.size;
                        if (filesize > 1024) {
                            filesize = filesize / 1024;
                            sizeLabel = "kb";

                            if (filesize > 1024) {
                                filesize = filesize / 1024;
                                sizeLabel = "MB";
                            }
                        }
                        var uploadListHtml = '<div class="uppy-list-item" data-id="' + value.id + '"><div class="uppy-list-label">' + value.name + ' (' + Math.round(filesize, 2) + ' ' + sizeLabel + ')</div><span class="uppy-list-remove" data-id="' + value.id + '"><i class="flaticon2-cancel-music"></i></span></div>';
                        $uploadedList.append(uploadListHtml);
                    });

                    $fileLabel.text("Add more files");

                    $statusBar.addClass('uppy-status-hidden');
                    $statusBar.removeClass('uppy-status-ongoing');
                });

                $(document).on('click', id + ' .uppy-list .uppy-list-remove', function () {
                    var itemId = $(this).attr('data-id');
                    uppyMin.removeFile(itemId);
                    $(id + ' .uppy-list-item[data-id="' + itemId + '"').remove();
                });
            }


            return {
                // public functions
                init: function (data) {
                    initUppy5(data);
                    setTimeout(function () {

                    }, 2000);
                }
            };
        }();

        KTUtil.ready(function () {
            KTUppy.init('mou_detail_upload');
            KTUppy.init('addition_mou_upload');
            KTUppy.init('edit_mou_upload');
            KTUppy.init('moa_upload');
        });

    </script>

    @*mou_basic_info*@
    <script>
        var listStatus = [
            {
                status_id: 1,
                status_name: 'Inactive'
            }
            ,
            {
                status_id: 2,
                status_name: 'Active'
            }
        ];
        var listScopes = [];
        var listPartner = [];
        var listTempExMOUPartnerScope = [];
        var listTempExMOUPartnerScopeEdit = [];

        $(document).ready(function () {
            getListOffice();
            loadListExMOU();
            pushDataToList();
        });

        function getListOffice(){
            $.ajax({
                url: "@Url.Action("getOffice", "BasicInfoMOU")",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                datatype: "json",
                success: function (data) {
                    var listOffice = data;
                    loadBasicInfo(listOffice);
                },
                error: function () {
                    //alert("fail");
                }
            });
        }

        function loadOffice(listOffice, OfficeData) {
            var HTMLOfficedata = "";
            for (i = 0; i < listOffice.length; i++) {
                if (listOffice[i].office_id == OfficeData.office_id) {
                    HTMLOfficedata += '<option value = "' + listOffice[i].office_id + '" selected>' + listOffice[i].office_abbreviation + '</option>'
                } else {
                    HTMLOfficedata += '<option value = "' + listOffice[i].office_id + '">' + listOffice[i].office_abbreviation + '</option>'
                }
            }
            $('#office').append(HTMLOfficedata);
        }

        function loadBasicInfo(listOffice) {
            $.ajax({
                url: "@Url.Action("getBasicInfo", "BasicInfoMOU")",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                datatype: "json",
                success: function (data) {
                    document.getElementById("mou_code").value = data.mou_code == null ? "" : data.mou_code;
                    document.getElementById("sign_date_mou").value = data.mou_start_date_string == null ? "" : data.mou_start_date_string;
                    document.getElementById("end_date_mou").value = data.mou_end_date_string == null ? "" : data.mou_end_date_string;
                    document.getElementById("reason").value = data.reason == null ? "" : data.reason;
                    document.getElementById("coop_scope").value = data.scopes == null ? "" : data.scopes;
                    document.getElementById("mou_note").value = data.mou_note == null ? "" : data.mou_note;
                    var OfficeData =
                    {
                        office_id: data.office_id,
                        office_abbreviation: data.office_abbreviation
                    };
                    loadOffice(listOffice, OfficeData);
                    loadStatus(data.mou_status_id);
                },
                error: function () {
                    //alert("fail");
                }
            });
    }

        function loadStatus(mou_status_id) {
            var HTMLStatusData = "";
            for (i = 0; i < listStatus.length; i++) {
                if (listStatus[i].status_id == mou_status_id) {
                    HTMLStatusData += '<option value = "' + listStatus[i].status_id + '" selected>' + listStatus[i].status_name + '</option>'
                } else {
                    HTMLStatusData += '<option value = "' + listStatus[i].status_id + '">' + listStatus[i].status_name + '</option>'
                }
            }
            $('#status').append(HTMLStatusData);
        }

        function saveBasicInfo() {
            var BasicInfo = {
                mou_code: $('#mou_code').val(),
                mou_end_date_string: $('#end_date_mou').val(),
                office_id: $('#office').val(),
                reason: $('#reason').val(),
                mou_note: $('#mou_note').val(),
                mou_status_id: $('#status').val()
            };
            $.ajax({
                url: "@Url.Action("editMOUBasicInfo", "BasicInfoMOU")",
                type: "POST",
                data: JSON.stringify(BasicInfo),
                contentType: "application/json;charset=utf-8",
                datatype: "json",
                cache: false,
                success: function (data) {

                },
                error: function () {
                    //alert("fail");
                }
            });
        }

        function loadListExMOU() {
            var mou_ex = $(".ex_mou").DataTable({
            oLanguage: {
                oPaginate: {
                    sPrevious: "Trang trước",
                    sNext: "Trang sau"
                },
                sEmptyTable: "Không có dữ liệu",
                sInfo: "Đang hiển thị từ _START_ đến _END_ của _TOTAL_ bản ghi",
            },
            searching: false,
            lengthChange: false,
            ajax: {
                    url: "@Url.Action("ViewExMOU", "BasicInfoMOU")",
                    type: "POST",
                    datatype: "json",
                    cache: "false"
                },
            columns: [
                { data: "mou_bonus_code" },
                { data: "mou_bonus_decision_date_string" },
                { data: "mou_bonus_end_date_string" },
                { data: "partner_name" },
                { data: "scope_abbreviation" },
                {
                    data: "evidence",
                    render: function (data) {
                        if (data == null) {
                            return "";
                        } else {
                            return '<a target="blank" href="' + data + '" data-toggle="modal"><span class="svg-icon svg-icon-dark svg-icon-md"><!--begin::Svg Icon | path:/var/www/preview.keenthemes.com/metronic/releases/2021-02-01-052524/theme/html/demo1/dist/../src/media/svg/icons/Design/Edit.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M7.71 3.5L1.15 15l3.43 6l6.55-11.5M9.73 15L6.3 21h13.12l3.43-6m-.57-1L15.42 2H8.57l6.86 12h6.85z" fill="#626262"/></svg><!--end::Svg Icon--></span></a>';
                        }
                    }
                },
                {
                    title: 'Hành động',
                    data: "mou_bonus_id",
                    orderable: false,
                    render: function (data) {
                        return '<a href="#edit_additional_mou" onclick=editExMOU(' + data + ') class="btn btn-sm btn-light-primary px-6 font-weight-bold" data-toggle="modal" style="margin-right: 10px;">Sửa</a>' +
                        '<a onclick="confirm_delete(' + data + ')" class="btn btn-sm btn-light-danger px-6 font-weight-bold" data-toggle="modal">Xóa</a>'
                    }
                }
                ],
                columnDefs: [
                    {
                        className: "text-center",
                        targets: '_all',
                    },
                ]
            });
        }

        function deleteExMOU(id) {
            Swal.fire({
                title: "Are you sure?",
                text: "You won't be able to revert this!",
                icon: "warning",
                showCancelButton: true,
                confirmButtonText: "Yes, delete it!",
                cancelButtonText: "No, cancel!",
                reverseButtons: true
            }).then(function (result) {
                if (result.value) {
                    $.ajax({
                        url: "@Url.Action("deleteExMOU", "BasicInfoMOU")",
                        data: { mou_bonus_id : id },
                        success: function (data) {
                            if (data = "") {
                                Swal.fire("Good job!", "You clicked the button!", "error");
                            } else {
                                Swal.fire("Deleted!", "Your file has been deleted.", "success")
                            }
                        },
                        error: function (data) {
                            Swal.fire("Good job!", "You clicked the button!", "error");
                        },
                    })
                }
            })
        };

        function addExMOU() {
            getNewExMOUCode();
        }

        function pushDataToList() {
            $("#coop_scope_ex_mou_add option").each(function (){
                listScopes.push({
                    scope_id: $(this).val(),
                    scope_abbreviation: $(this).text()
                });
            });
            $("#partner_name_ex_mou_add option").each(function () {
                listPartner.push({
                    partner_id: $(this).val(),
                    partner_name: $(this).text()
                });
            });

        }

        function addExMOUTemp() {
            var partner_id = $('#partner_name_ex_mou_add').val();
            var scopes = $('#coop_scope_ex_mou_add').val();

            var scopes_name = '';
            for (i = 0; i < scopes.length; i++) {
                var objScope = listScopes.find(x => x.scope_id == scopes[i]);
                scopes_name += objScope.scope_abbreviation + ',';
            }

            var objPartner = listPartner.find(x => x.partner_id == partner_id);
            var partner_name = objPartner.partner_name;

            if (scopes_name.endsWith(",")) {
                scopes_name = scopes_name.slice(0, -1);
            }

            var temp = {
                partner_id: partner_id,
                partner_name: partner_name,
                scopes_id: scopes,
                scopes_name: scopes_name,
            }

            listTempExMOUPartnerScope.push(temp);
            clearInputAddExMOUPartner();
            initAndRefreshTableExMOUAdd();
        }

        function clearInputAddExMOUPartner() {
            document.getElementById("coop_scope_ex_mou_add").value = "";
            document.getElementById("partner_name_ex_mou_add").value = "";
        }

        function initAndRefreshTableExMOUAdd() {
            resetExMOUAddTable();
            initExMOUAddTable();
        }

        function resetExMOUAddTable() {
            for (idx = 0; idx < listTempExMOUPartnerScope.length; idx++) {
                $("#tempExMOU" + idx).remove();
            }
        }

        function initExMOUAddTable() {
            var HTMLdata = null;
            for (idx = 0; idx < listTempExMOUPartnerScope.length; idx++) {
                HTMLdata += '<tr id="tempExMOU' + idx + '" "class="MOUPartnerTempList">';
                HTMLdata += '<td>' + (idx + 1) + '</td>';
                HTMLdata += '<td>' + listTempExMOUPartnerScope[idx].partner_name + '</td>';
                HTMLdata += '<td>' + listTempExMOUPartnerScope[idx].scopes_name + '</td>';

                var buttonEdit = '<a onclick="loadEditExMOUTemp(' + idx + ')" href="#edit-partner-scope" data-toggle="modal" class="btn btn-sm btn-light-primary px-6 font-weight-bold" style="margin-right: 10px;">Sửa</a>';
                var buttonDel = '<a onclick="confirm_delete_ex_mou_temp(' + (idx) + ')" class="btn btn-sm btn-light-danger px-6 font-weight-bold" data-toggle="modal">Xóa</a>'
                HTMLdata += '<td class="text-center">' + buttonEdit + buttonDel + '</td>';
                HTMLdata += '</tr>';
            }
            $('#ex_mou_table_add').append(HTMLdata);
        }

        function loadEditExMOUTemp(index) {
            $("#idx_ex_mou_edit").val(index);
            var HTMLPartnerdata = "";
            var HTMLScopedata = "";
            $('#partner_name_ex_mou_edit').empty();
            $('#coop_scope_ex_mou_edit').empty();
            for (i = 0; i < listPartner.length; i++) {
                if (listTempExMOUPartnerScope[index].partner_id == listPartner[i].partner_id) {
                    HTMLPartnerdata += '<option value = "' + listPartner[i].partner_id + '" selected>' + listPartner[i].partner_name + '</option>'
                } else {
                    HTMLPartnerdata += '<option value = "' + listPartner[i].partner_id + '" >' + listPartner[i].partner_name + '</option>'
                }
            }
            for (j = 0; j < listScopes.length; j++) {
                if (listTempExMOUPartnerScope[index].scopes_id.includes(listScopes[j].scope_id)) {
                    HTMLScopedata += '<option value = "' + listScopes[j].scope_id + '" selected>' + listScopes[j].scope_abbreviation + '</option>'
                } else {
                    HTMLScopedata += '<option value = "' + listScopes[j].scope_id + '">' + listScopes[j].scope_abbreviation + '</option>'
                }
            }

            $('#partner_name_ex_mou_edit').append(HTMLPartnerdata);
            $('#coop_scope_ex_mou_edit').append(HTMLScopedata);
        };

        function editExMOUTemp() {
            var index = $("#idx_ex_mou_edit_for_edit").val();

            var partner_id = $('#partner_name_ex_mou_edit').val();
            var scopes = $('#coop_scope_ex_mou_edit').val();

            var scopes_name = '';
            for (i = 0; i < scopes.length; i++) {
                var objScope = listScopes.find(x => x.scope_id == scopes[i]);
                scopes_name += objScope.scope_abbreviation + ',';
            }

            var objPartner = listPartner.find(x => x.partner_id == partner_id);
            var partner_name = objPartner.partner_name;

            if (scopes_name.endsWith(",")) {
                scopes_name = scopes_name.slice(0, -1);
            }

            listTempExMOUPartnerScope[index].partner_id = partner_id;
            listTempExMOUPartnerScope[index].partner_name = partner_name;
            listTempExMOUPartnerScope[index].scopes_id = scopes;
            listTempExMOUPartnerScope[index].scopes_name = scopes_name;
            initAndRefreshTableExMOUAdd();
        }

        function confirm_delete_ex_mou_temp(index) {
            Swal.fire({
                title: "Are you sure?",
                text: "You won't be able to revert this!",
                icon: "warning",
                showCancelButton: true,
                confirmButtonText: "Yes, delete it!",
                cancelButtonText: "No, cancel!",
                reverseButtons: true
            }).then(function (result) {
                if (result.isConfirmed) {
                    resetExMOUAddTable();
                    listTempExMOUPartnerScope.splice(index, 1);
                    initAndRefreshTableExMOUAdd();
                }
            })
        }

        function getNewExMOUCode() {
            $.ajax({
                url: "@Url.Action("getNewExtraMOUCode", "BasicInfoMOU")",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                datatype: "json",
                cache: false,
                success: function (data) {
                    $('#ex_mou_id_add').val(data);
                },
                error: function () {
                    //alert("fail");
                }
            });
        }

        function finishExMOUAdd() {
            var ExBasicInfo = {
                ex_mou_code: $('#ex_mou_id_add').val() ,
                ex_mou_sign_date: $('#mou_addition_sign_time').val(),
                ex_mou_end_date: $('#mou_addition_end_time').val()
            };

            var ExMOUAdd = {
                ExBasicInfo: ExBasicInfo,
                PartnerScopeInfo: listTempExMOUPartnerScope,
            };

            $.ajax({
                url: "@Url.Action("Add_Ex_Mou", "BasicInfoMOU")",
                type: "POST",
                data: JSON.stringify(ExMOUAdd),
                contentType: "application/json;charset=utf-8",
                datatype: "json",
                cache: false,
                success: function (data) {
                    listTempExMOUPartnerScope = [];
                },
                error: function () {
                    //alert("fail");
                }
            });
        }

        function editExMOU(mou_bonus_id){
            $.ajax({
                url: "@Url.Action("ViewExMOUDetail", "BasicInfoMOU")",
                data: { mou_bonus_id: mou_bonus_id },
                success: function (data) {
                    $('#ex_mou_id_edit').val(data.ExBasicInfo.ex_mou_code);
                    $('#mou_addition_sign_time_edit').val(data.ExBasicInfo.ex_mou_sign_date);
                    $('#mou_addition_end_time_edit').val(data.ExBasicInfo.ex_mou_end_date);
                    addToPartnerScopeListEdit(data);
                },
                error: function (data) {

                },
            });
        }

        function addToPartnerScopeListEdit(data) {
            listTempExMOUPartnerScopeEdit = [];
            for (i = 0; i < data.PartnerScopeInfo.length; i++){
                var partner_id = data.PartnerScopeInfo[i].partner_id;
                var scopes = data.PartnerScopeInfo[i].scopes_id;
                var scopes_name = '';
                for (i = 0; i < scopes.length; i++) {
                    var objScope = listScopes.find(x => x.scope_id == scopes[i]);
                    if (objScope != null) {
                        scopes_name += objScope.scope_abbreviation + ',';
                    }
                }
                var objPartner = listPartner.find(x => x.partner_id == partner_id);
                var partner_name = objPartner.partner_name;

                if (scopes_name.endsWith(",")) {
                    scopes_name = scopes_name.slice(0, -1);
                }
                var temp = {
                    partner_id: partner_id,
                    partner_name: partner_name,
                    scopes_id: scopes,
                    scopes_name: scopes_name,
                }
                listTempExMOUPartnerScopeEdit.push(temp);
            }
            initAndRefreshTableExMOUEdit();
        }

        function initAndRefreshTableExMOUEdit(){
            resetExMOUEditTable();
            initExMOUEditTable();
        }

        function resetExMOUEditTable() {
            for (idx = 0; idx < listTempExMOUPartnerScopeEdit.length; idx++) {
                $("#tempExMOUEdit" + idx).remove();
            }
        }

        function initExMOUEditTable() {
            var HTMLdata = null;
            for (idx = 0; idx < listTempExMOUPartnerScopeEdit.length; idx++) {
                HTMLdata += '<tr id="tempExMOUEdit' + idx + '" "class="MOUPartnerTempList">';
                HTMLdata += '<td>' + (idx + 1) + '</td>';
                HTMLdata += '<td>' + listTempExMOUPartnerScopeEdit[idx].partner_name + '</td>';
                HTMLdata += '<td>' + listTempExMOUPartnerScopeEdit[idx].scopes_name + '</td>';

                var buttonEdit = '<a onclick="loadEditExMOUTempForEdit(' + idx + ')" href="#edit-partner-scope-edit" data-toggle="modal" class="btn btn-sm btn-light-primary px-6 font-weight-bold" style="margin-right: 10px;">Sửa</a>';
                var buttonDel = '<a onclick="confirm_delete_ex_mou_temp_edit(' + (idx) + ')" class="btn btn-sm btn-light-danger px-6 font-weight-bold" data-toggle="modal">Xóa</a>'
                HTMLdata += '<td class="text-center">' + buttonEdit + buttonDel + '</td>';
                HTMLdata += '</tr>';
            }
            $('#ex_mou_table_edit').append(HTMLdata);
        }

        function loadEditExMOUTempForEdit(index) {
            $("#idx_ex_mou_edit_for_edit").val(index);
            var HTMLPartnerdata = "";
            var HTMLScopedata = "";
            $('#partner_name_ex_mou_edit_for_edit').empty();
            $('#coop_scope_ex_mou_edit_for_edit').empty();
            for (i = 0; i < listPartner.length; i++) {
                if (listTempExMOUPartnerScopeEdit[index].partner_id == listPartner[i].partner_id) {
                    HTMLPartnerdata += '<option value = "' + listPartner[i].partner_id + '" selected>' + listPartner[i].partner_name + '</option>'
                } else {
                    HTMLPartnerdata += '<option value = "' + listPartner[i].partner_id + '" >' + listPartner[i].partner_name + '</option>'
                }
            }
            for (j = 0; j < listScopes.length; j++) {
                if (listTempExMOUPartnerScopeEdit[index].scopes_id.includes(listScopes[j].scope_id)) {
                    HTMLScopedata += '<option value = "' + listScopes[j].scope_id + '" selected>' + listScopes[j].scope_abbreviation + '</option>'
                } else {
                    HTMLScopedata += '<option value = "' + listScopes[j].scope_id + '">' + listScopes[j].scope_abbreviation + '</option>'
                }
            }

            $('#partner_name_ex_mou_edit_for_edit').append(HTMLPartnerdata);
            $('#coop_scope_ex_mou_edit_for_edit').append(HTMLScopedata);
        }

        function confirm_delete_ex_mou_temp_edit(index) {
            Swal.fire({
                title: "Are you sure?",
                text: "You won't be able to revert this!",
                icon: "warning",
                showCancelButton: true,
                confirmButtonText: "Yes, delete it!",
                cancelButtonText: "No, cancel!",
                reverseButtons: true
            }).then(function (result) {
                if (result.isConfirmed) {
                    resetExMOUEditTable();
                    listTempExMOUPartnerScopeEdit.splice(index, 1);
                    initAndRefreshTableExMOUEdit();
                }
            })
        }

        function editExMOUTempForEdit() {
            var index = $("#idx_ex_mou_edit_for_edit").val();

            var partner_id = $('#partner_name_ex_mou_edit_for_edit').val();
            var scopes = $('#coop_scope_ex_mou_edit_for_edit').val();

            var scopes_name = '';
            for (i = 0; i < scopes.length; i++) {
                var objScope = listScopes.find(x => x.scope_id == scopes[i]);
                scopes_name += objScope.scope_abbreviation + ',';
            }

            var objPartner = listPartner.find(x => x.partner_id == partner_id);
            var partner_name = objPartner.partner_name;

            if (scopes_name.endsWith(",")) {
                scopes_name = scopes_name.slice(0, -1);
            }

            listTempExMOUPartnerScopeEdit[index].partner_id = partner_id;
            listTempExMOUPartnerScopeEdit[index].partner_name = partner_name;
            listTempExMOUPartnerScopeEdit[index].scopes_id = scopes;
            listTempExMOUPartnerScopeEdit[index].scopes_name = scopes_name;
            initAndRefreshTableExMOUEdit();
        }

        function addExMOUTempForEdit() {
            var partner_id = $('#partner_name_ex_mou_add_for_edit').val();
            var scopes = $('#coop_scope_ex_mou_add_for_edit').val();

            var scopes_name = '';
            for (i = 0; i < scopes.length; i++) {
                var objScope = listScopes.find(x => x.scope_id == scopes[i]);
                scopes_name += objScope.scope_abbreviation + ',';
            }

            var objPartner = listPartner.find(x => x.partner_id == partner_id);
            var partner_name = objPartner.partner_name;

            if (scopes_name.endsWith(",")) {
                scopes_name = scopes_name.slice(0, -1);
            }

            var temp = {
                partner_id: partner_id,
                partner_name: partner_name,
                scopes_id: scopes,
                scopes_name: scopes_name,
            }

            listTempExMOUPartnerScopeEdit.push(temp);
            //clearInputAddExMOUPartner();
            initAndRefreshTableExMOUEdit();
        }

        function finishExMOUEdit() {
            var ExBasicInfo = {
                ex_mou_code: $('#ex_mou_id_edit').val() ,
                ex_mou_sign_date: $('#mou_addition_sign_time_edit').val(),
                ex_mou_end_date: $('#mou_addition_end_time_edit').val()
            };

            var ExMOUAdd = {
                ExBasicInfo: ExBasicInfo,
                PartnerScopeInfo: listTempExMOUPartnerScopeEdit,
            };

            $.ajax({
                url: "@Url.Action("Edit_Ex_Mou", "BasicInfoMOU")",
                type: "POST",
                data: JSON.stringify(ExMOUAdd),
                contentType: "application/json;charset=utf-8",
                datatype: "json",
                cache: false,
                success: function (data) {
                    listTempExMOUPartnerScopeEdit = [];
                },
                error: function () {
                    //alert("fail");
                }
            });
        }
</script>

    @*mou_partner*@
    <script>
        var listSpeMOUPartner = [];
        var listScopeMOUPartner = [];
        var listPartnerMOUPartner = [];

    $(document).ready(function () {
        loadListPartnerMOU();
        addToList();
        loadMOAList();
    });

    function addToList() {
        $("#mou_partner_specialization_add option").each(function () {
            listSpeMOUPartner.push({
                spe_id: $(this).val(),
                spe_name: $(this).text()
            });
        });
        $("#mou_partner_scope_add option").each(function () {
            listScopeMOUPartner.push({
                scope_id: $(this).val(),
                scope_name: $(this).text()
            });
        });
        $("#mou_partner_name_add option").each(function () {
            listPartnerMOUPartner.push({
                partner_name: $(this).val()
            });
        });
    }

    function loadListPartnerMOU() {
        var rowIdx = 1;
        var mou_partner_table = $("#partner_table").DataTable({
            oLanguage: {
                oPaginate: {
                    sPrevious: "Trang trước",
                    sNext: "Trang sau"
                },
                sEmptyTable: "Không có dữ liệu",
                sInfo: "Đang hiển thị từ _START_ đến _END_ của _TOTAL_ bản ghi",
            },
            searching: false,
            lengthChange: false,
            ajax: {
                    url: "@Url.Action("ViewListMOUPartner", "PartnerMOU")",
                    type: "POST",
                    datatype: "json",
                    data: {
                        "partner_name": function () { return $('#search_partner_name').val() },
                        "nation": function () { return $('#search_nation').val() },
                        "specialization": function () { return $('#search_specialization').val() },
                    },
                    cache: "false"
            }
            ,
            columns: [
                {
                    render: function () {
                        return rowIdx++;
                    }
                },
                { data: "partner_name" },
                { data: "country_name" },
                { data: "specialization_name" },
                {
                    data: "website",
                    render: function (data) {
                        if (data == null) {
                            return "";
                        } else {
                            return '<a target="blank" href="' + data + '"><span class="svg-icon svg-icon-dark svg-icon-md"><!--begin::Svg Icon | path:/var/www/preview.keenthemes.com/metronic/releases/2021-02-01-052524/theme/html/demo1/dist/../src/media/svg/icons/Design/Edit.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none"><path d="M13.544 10.456a4.368 4.368 0 0 0-6.176 0l-3.089 3.088a4.367 4.367 0 1 0 6.177 6.177L12 18.177m-1.544-4.633a4.368 4.368 0 0 0 6.177 0l3.088-3.088a4.368 4.368 0 0 0-6.177-6.177L12 5.823" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></g></svg><!--end::Svg Icon--></span></a>';
                        }
                    }
                },
                { data: "contact_point_name" },
                { data: "contact_point_phone" },
                { data: "contact_point_email" },
                { data: "mou_start_date_string" },
                { data: "scope_abbreviation" }
                ,
                {
                    title: 'Hành động',
                    data:
                    {
                        mou_partner_id: "mou_partner_id",
                        mou_code: "mou_code",
                        partner_name: "partner_name"
                    },
                    orderable: false,
                    width: '250px',
                    render: function (data, type, full, meta, row) {
                        return '<a onclick="show_status_history(' + data.mou_partner_id + ',\'' + data.mou_code +'\',\'' + data.partner_name + '\')" class="show-status-history" href="#mou_partner_history" data-toggle="modal"><span class="svg-icon svg-icon-dark svg-icon-sm"><!--begin::Svg Icon | path:/var/www/preview.keenthemes.com/metronic/releases/2021-02-01-052524/theme/html/demo1/dist/../src/media/svg/icons/Code/Time-schedule.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 512 512"><path d="M504 255.531c.253 136.64-111.18 248.372-247.82 248.468c-59.015.042-113.223-20.53-155.822-54.911c-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184c0-101.705-82.311-184-184-184c-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z" fill="black"/></svg><!--end::Svg Icon--></span></a> '
                        + '<a href="#edit_partner_mou" onclick=goDetailMOUPartner(' + data + ') class="btn btn-sm btn-light-primary px-6 font-weight-bold" style="margin-right: 10px;" data-toggle="modal">Sửa</a>' +
                            '<a onclick="confirm_delete_partner_mou(' + data + ')" class="btn btn-sm btn-light-danger px-6 font-weight-bold" data-toggle="modal">Xóa</a>'
                    }
                },
            ],
            initComplete: function () {
                $('#partner_table').parent().css('overflow-x', 'auto');
                $('#partner_table').parent().removeClass();
            }
        });
    }

    function checkPartnerAdd() {
        var partner_name = document.getElementById("mou_partner_name_add").value;
        var em = { partner_name: partner_name };
        $.ajax({
            url: "@Url.Action("CheckPartner", "MOU")",
            type: "POST",
            data: JSON.stringify(em),
            contentType: "application/json;charset=utf-8",
            datatype: "json",
            success: function (data) {
                if (data == "") {
                    document.getElementById('mou_partner_nation_add').removeAttribute('disabled');
                    document.getElementById('mou_partner_website_add').removeAttribute('disabled');
                    document.getElementById('mou_partner_address_add').removeAttribute('disabled');
                    document.getElementById("mou_partner_nation_add").value = "";
                    document.getElementById("mou_partner_website_add").value = "";
                    document.getElementById("mou_partner_address_add").value = "";
                    document.getElementById("partner_id_add").value = "";
                } else {
                    document.getElementById('mou_partner_nation_add').setAttribute('disabled', '');
                    document.getElementById('mou_partner_website_add').setAttribute('disabled', '');
                    document.getElementById('mou_partner_address_add').setAttribute('disabled', '');
                    document.getElementById("mou_partner_nation_add").value = data.country_name == null ? "" : data.country_name;
                    document.getElementById("mou_partner_website_add").value = data.website == null ? "" : data.website;
                    document.getElementById("mou_partner_address_add").value = data.address == null ? "" : data.address;
                    document.getElementById("partner_id_add").value = data.partner_id == null ? "" : data.partner_id;
                }
                document.getElementById("add_mou_partner_button").removeAttribute('disabled');
            },
            error: function () {
                //alert("fail");
            }
        });
    }

    function addMOUPartner(){
        var PartnerInfo = {
            partnername_add: document.getElementById("mou_partner_name_add").value,
            represent_add: document.getElementById("mou_partner_represent_add").value,
            specialization_add: $("#mou_partner_specialization_add").val(),
            nation_add: document.getElementById("mou_partner_nation_add").value,
            website_add: document.getElementById("mou_partner_website_add").value,
            address_add: document.getElementById("mou_partner_address_add").value,
            email_add: document.getElementById("mou_partner_email_add").value,
            sign_date_mou_add: document.getElementById("mou_sign_date_partner_add").value,
            phone_add: document.getElementById("mou_partner_phone_add").value,
            coop_scope_add: $("#mou_partner_scope_add").val(),
            partner_id: document.getElementById("partner_id_add").value,
        }
        $.ajax({
            url: "@Url.Action("Add_Mou_Partner", "PartnerMOU")",
            type: "POST",
            data: JSON.stringify(PartnerInfo),
            contentType: "application/json;charset=utf-8",
            datatype: "json",
            cache: false,
            success: function (data) {

            },
            error: function () {
                //alert("fail");
            }
        });
    }

    function goDetailMOUPartner(mou_partner_id) {
        var em = { mou_partner_id: mou_partner_id };
        $.ajax({
            url: "@Url.Action("Get_Data_Partner_Detail", "PartnerMOU")",
            type: "POST",
            data: JSON.stringify(em),
            contentType: "application/json;charset=utf-8",
            datatype: "json",
            cache: false,
            success: function (data) {
                $("#mou_partner_represent_edit").val(data.contact_point_name);
                $("#mou_partner_nation_edit").val(data.country_name);
                $("#mou_partner_email_edit").val(data.contact_point_email);
                $("#mou_sign_date_partner_edit").val(data.mou_start_date_string);
                $("#mou_partner_website_edit").val(data.website);
                $("#mou_partner_phone_edit").val(data.contact_point_phone);
                $("#mou_partner_address_edit").val(data.address);
                loadDataMOUPartnerForEdit(data);
            },
            error: function () {
                //alert("fail");
            }
        });
    }

    function loadDataMOUPartnerForEdit(data) {
            var HTMLSpedata = "";
            var HTMLScopedata = "";
            var HTMLPartnerdata = "";
            $('#mou_partner_specialization_edit').empty();
            $('#mou_partner_scope_edit').empty();

            for (i = 0; i < listSpeMOUPartner.length; i++) {
                if (data.specialization_name.includes(listSpeMOUPartner[i].spe_name)) {
                    HTMLSpedata += '<option value = "' + listSpeMOUPartner[i].spe_id + '" selected>' + listSpeMOUPartner[i].spe_name + '</option>'
                } else {
                    HTMLSpedata += '<option value = "' + listSpeMOUPartner[i].spe_id + '" >' + listSpeMOUPartner[i].spe_name + '</option>'
                }
            }
            for (j = 0; j < listScopeMOUPartner.length; j++) {
                if (data.scope_abbreviation.includes(listScopeMOUPartner[j].scope_name)) {
                    HTMLScopedata += '<option value = "' + listScopeMOUPartner[j].scope_id + '" selected>' + listScopeMOUPartner[j].scope_name + '</option>'
                } else {
                    HTMLScopedata += '<option value = "' + listScopeMOUPartner[j].scope_id + '">' + listScopeMOUPartner[j].scope_name + '</option>'
                }
            }
        for (k = 0; k < listPartnerMOUPartner.length; k++) {
                if (data.partner_name == listPartnerMOUPartner[k].partner_name) {
                    HTMLPartnerdata += '<option value = "' + listPartnerMOUPartner[k].partner_name + '" selected>' + listPartnerMOUPartner[k].partner_name + '</option>'
                } else {
                    HTMLPartnerdata += '<option value = "' + listPartnerMOUPartner[k].partner_name + '">' + listPartnerMOUPartner[k].partner_name + '</option>'
                }
            }
            $('#mou_partner_specialization_edit').append(HTMLSpedata);
            $('#mou_partner_scope_edit').append(HTMLScopedata);
            $('#mou_partner_name_edit').append(HTMLPartnerdata);
        }

    function checkPartnerEdit() {
            var partner_name = document.getElementById("mou_partner_name_edit").value;
            var em = { partner_name: partner_name };
            $.ajax({
                url: "@Url.Action("CheckPartner", "MOU")",
                type: "POST",
                data: JSON.stringify(em),
                contentType: "application/json;charset=utf-8",
                datatype: "json",
                success: function (data) {
                    if (data == "") {
                        document.getElementById('mou_partner_nation_edit').removeAttribute('disabled');
                        document.getElementById('mou_partner_website_edit').removeAttribute('disabled');
                        document.getElementById('mou_partner_address_edit').removeAttribute('disabled');
                        document.getElementById("mou_partner_nation_edit").value = "";
                        document.getElementById("mou_partner_website_edit").value = "";
                        document.getElementById("mou_partner_address_edit").value = "";
                        document.getElementById("partner_id_edit").value = "";
                    } else {
                        document.getElementById('mou_partner_nation_edit').setAttribute('disabled', '');
                        document.getElementById('mou_partner_website_edit').setAttribute('disabled', '');
                        document.getElementById('mou_partner_address_edit').setAttribute('disabled', '');
                        document.getElementById("mou_partner_nation_edit").value = data.country_name == null ? "" : data.country_name;
                        document.getElementById("mou_partner_website_edit").value = data.website == null ? "" : data.website;
                        document.getElementById("mou_partner_address_edit").value = data.address == null ? "" : data.address;
                        document.getElementById("partner_id_edit").value = data.partner_id == null ? "" : data.partner_id;
                    }
                    document.getElementById("edit_mou_partner_button").removeAttribute('disabled');
                },
                error: function () {
                    //alert("fail");
                }
            });
        }

    function editMOUPartner()
    {
        var PartnerInfo = {
            partnername_add: document.getElementById("mou_partner_name_add").value,
            represent_add: document.getElementById("mou_partner_represent_add").value,
            specialization_add: $("#mou_partner_specialization_add").val(),
            nation_add: document.getElementById("mou_partner_nation_add").value,
            website_add: document.getElementById("mou_partner_website_add").value,
            address_add: document.getElementById("mou_partner_address_add").value,
            email_add: document.getElementById("mou_partner_email_add").value,
            sign_date_mou_add: document.getElementById("mou_sign_date_partner_add").value,
            phone_add: document.getElementById("mou_partner_phone_add").value,
            coop_scope_add: $("#mou_partner_scope_add").val(),
            partner_id: document.getElementById("partner_id_add").value,
        }
        $.ajax({
            url: "@Url.Action("Add_Mou_Partner", "PartnerMOU")",
            type: "POST",
            data: JSON.stringify(PartnerInfo),
            contentType: "application/json;charset=utf-8",
            datatype: "json",
            cache: false,
            success: function (data) {

            },
            error: function () {
                //alert("fail");
            }
        });
    }

    function confirm_delete_partner_mou(id) {
            var link = '@Url.Action("deletePartnerMOU", "PartnerMOU")'
            Swal.fire({
                title: "Are you sure?",
                text: "You won't be able to revert this!",
                icon: "warning",
                showCancelButton: true,
                confirmButtonText: "Yes, delete it!",
                cancelButtonText: "No, cancel!",
                reverseButtons: true
            }).then(function (result) {
                if (result.value) {
                    $.ajax({
                        url: link,
                        data: { mou_id : id },
                        success: function (data) {
                            if (data = "") {
                                Swal.fire("Good job!", "You clicked the button!", "error");
                            } else {
                                Swal.fire("Deleted!", "Your file has been deleted.", "success")
                            }
                        },
                        error: function (data) {
                            Swal.fire("Good job!", "You clicked the button!", "error");
                        },
                    })
                }
            })
    };

    function show_status_history(mou_partner_id, mou_id, partner_name) {
        var rowIdx = 1;
        $('#mou_id_history').val(mou_id);
        $('#partner_name_history').val(partner_name);
        var history_table = $("#history-table").DataTable({
            oLanguage: {
                oPaginate: {
                    sPrevious: "Trang trước",
                    sNext: "Trang sau"
                },
                sEmptyTable: "Không có dữ liệu",
                sInfo: "Đang hiển thị từ _START_ đến _END_ của _TOTAL_ bản ghi",
            },
            searching: false,
            lengthChange: false,
            ajax: {
                    url: "@Url.Action("Get_MOU_History", "PartnerMOU")",
                    type: "POST",
                    data: { mou_partner_id: mou_partner_id },
                    datatype: "json",
                    cache: "false"
                },
            columns: [
                {
                    render: function () {
                        return rowIdx++;
                    }
                },
                { data: "content" },
                { data: "full_name" },
                { data: "add_time_string" }
                ],
            initComplete: function () {
                $('#history-table').parent().css('overflow-x', 'auto');
                $('#history-table').parent().removeClass();
            }
        });
    }
    </script>

    @*moa*@
    <script>
    var moa_table;
    var listTempPartnerMOAAdd = [];
    var listScopesMOA = [];
    var listPartnersMOA = [];

    function searchMOA() {
        moa_table.ajax.reload();
    }

    function loadMOAList() {
        var rowIdx = 1;
            moa_table = $("#moa_table").DataTable({
            oLanguage: {
                oPaginate: {
                    sPrevious: "Trang trước",
                    sNext: "Trang sau"
                },
                sEmptyTable: "Không có dữ liệu",
                sInfo: "Đang hiển thị từ _START_ đến _END_ của _TOTAL_ bản ghi",
            },
            searching: false,
                lengthChange: false
            ,
            //initComplete: function () {
            //    $('#moa_table').parent().css('overflow-x', 'auto');
            //    $('#moa_table').parent().removeClass();
            //},
            ajax: {
                    url: "@Url.Action("ViewMOA", "MOA")",
                    type: "POST",
                    datatype: "json",
                    data: {
                        "partner_name": function () { return $('#search_partner_name_moa').val() },
                        "moa_code": function () { return $('#search_moa_code_moa').val() },
                    },
                    cache: "false"
            },
            columns: [
                {
                    render: function () {
                        return rowIdx++;
                    }
                },
                { data: "moa_code" },
                { data: "partner_name" },
                {
                    data: "evidence",
                    render: function (data) {
                        if (data == null) {
                            return "";
                        } else {
                            return '<a target="blank" href="' + data + '" data-toggle="modal"><span class="svg-icon svg-icon-dark svg-icon-md"><!--begin::Svg Icon | path:/var/www/preview.keenthemes.com/metronic/releases/2021-02-01-052524/theme/html/demo1/dist/../src/media/svg/icons/Design/Edit.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M7.71 3.5L1.15 15l3.43 6l6.55-11.5M9.73 15L6.3 21h13.12l3.43-6m-.57-1L15.42 2H8.57l6.86 12h6.85z" fill="#626262"/></svg><!--end::Svg Icon--></span></a>';
                        }
                    }
                },
                { data: "moa_start_date_string" },
                { data: "moa_end_date_string" },
                { data: "office_name" },
                { data: "scope_abbreviation" },
                {
                    data: "mou_status_id",
                    width: '150px',
                    render: function (data) {
                        var status = {
                            1: {
                                'title': 'Inactive',
                                'class': 'label-light-danger'
                            },
                            2: {
                                'title': 'Active',
                                'class': 'label-light-success'
                            }
                        };
                        if (typeof status[data] === 'undefined') {
                            return data;
                        }
                        return '<span class="label label-lg font-weight-bold ' + status[data].class + ' label-inline">' + status[data].title + '</span> ';
                    }
                },
                {
                    title: 'Hành động',
                    data: "moa_id",
                    orderable: false,
                    width: '125px',
                    render: function (data, type, full, meta) {
                        return '<a onclick=goDetailMOA('+data+') class="btn btn-sm btn-light-primary px-6 font-weight-bold" style="margin-right: 10px;">Sửa</a>' +
                            '<a onclick="confirm_delete_moa(' + data + ')" class="btn btn-sm btn-light-danger px-6 font-weight-bold" data-toggle="modal">Xóa</a>'
                    }
                },
                ]
            //,
            //columnDefs: [
            //    {
            //        className: "text-center",
            //        targets: [0, 4, 9, 12, 13, 14],
            //    },
            //    {
            //        className: "text-nowrap",
            //        targets: [5, 6, 8, -1]
            //    },
            //],
    });
        }

    function nextStep() {
        toggleNextStep();
    }

    function backToStep() {
        updateMOAStartDateAndMainScope();
        toggleBackStep();
    }

    //temp code
    function goDetailMOA(moa_id) {
        var id = { id: moa_id };
        $.ajax({
            url: "@Url.Action("PassDataToMOADetail", "BasicInfoMOA")",
            type: "POST",
            contentType: "application/json;charset=utf-8",
            data: JSON.stringify(id),
            datatype: "json",
            cache: false,
            success: function (data) {
                window.location.href = '../MOA/Detail_MOA';
            },
            error: function () {

            }
        });
    }

    function addMOA() {
        //collect basicInfo data.
        var BasicInfo = {
            moa_code: $('#moa_code').val() ,
            moa_end_date: $('#end_date_moa').val(),
            mou_status_id: $('#status_moa').val(),
            reason: $('#note_moa').val(),
            moa_note: $('#moa_area').val()
        };
        var MOAAdd = {
            MOABasicInfo: BasicInfo,
            MOAPartnerInfo: listTempPartnerMOAAdd,
        };
        $.ajax({
            url: "@Url.Action("Add_Moa", "MOA")",
            type: "POST",
            data: JSON.stringify(MOAAdd),
            contentType: "application/json;charset=utf-8",
            datatype: "json",
            cache: false,
            success: function (data) {

            },
            error: function () {
                //alert("fail");
            }
        });

        //collect Partner data.
        //Send to controller.
    }

    function updateMOAStartDateAndMainScope() {
        var max_date = '01/01/0001';
        var main_scopes = '';

        for (idx = 0; idx < listTempPartnerMOAAdd.length; idx++){
            if (Date.parse(listTempPartnerMOAAdd[idx].sign_date_mou_add) > Date.parse(max_date)) {
                max_date = listTempPartnerMOAAdd[idx].sign_date_mou_add;
            }
            for (i = 0; i < listTempPartnerMOAAdd[idx].list_scope.length; i++){
                if ((listTempPartnerMOAAdd[idx].coop_scope_add+'').includes(listTempPartnerMOAAdd[idx].list_scope[i].scope_id)) {
                    if (!main_scopes.includes(listTempPartnerMOAAdd[idx].list_scope[i].scope_abbreviation)) {
                        main_scopes += listTempPartnerMOAAdd[idx].list_scope[i].scope_abbreviation + ',';
                    }
                }
            }
        }

        //remove last element.
        if (main_scopes.endsWith(",")) {
            main_scopes = main_scopes.slice(0, -1);
        }

        if (max_date == '01/01/0001') {
            max_date = '';
        }

        $("#sign_date_moa").val(max_date);
        $("#coop_scope_moa").val(main_scopes);
    }

    function loadEditTempMOA(index) {
        $("#idx_moa_edit").val(index);
        var HTMLScopesdata = "";
        var HTMLPartnerdata = "";

        $('#moa_partner_scope_edit').empty();
        $('#moa_partner_name_edit').empty();

        var coop_scope_add = listTempPartnerMOAAdd[index].coop_scope_add + '';
        var partnername_add = listTempPartnerMOAAdd[index].partnername_add + '';
        var list_scope = listTempPartnerMOAAdd[index].list_scope;

        for (i = 0; i < list_scope.length; i++) {
            if (coop_scope_add.includes(list_scope[i].scope_id)) {
                HTMLScopesdata += '<option value="' + list_scope[i].scope_id + '" selected>' + list_scope[i].scope_abbreviation + '</option>';
            } else {
                HTMLScopesdata += '<option value="' + list_scope[i].scope_id + '">' + list_scope[i].scope_abbreviation + '</option>';
            }
        }
        $('#moa_partner_scope_edit').append(HTMLScopesdata);
        for (j = 0; j < listPartnersMOA.length; j++) {
            if (partnername_add == listPartnersMOA[j].partner_name) {
                HTMLPartnerdata += '<option value="' + listPartnersMOA[j].partner_name + '" selected>' + listPartnersMOA[j].partner_name + '</option>';
            } else {
                HTMLPartnerdata += '<option value="' + listPartnersMOA[j].partner_name + '">' + listPartnersMOA[j].partner_name + '</option>';
            }
        }
        $('#moa_partner_name_edit').append(HTMLPartnerdata);

        $('#moa_partner_represent_edit').val(listTempPartnerMOAAdd[index].represent_add);
        $('#moa_partner_nation_edit').val(listTempPartnerMOAAdd[index].nation_add);
        $('#moa_partner_website_edit').val(listTempPartnerMOAAdd[index].website_add);
        $('#moa_partner_address_edit').val(listTempPartnerMOAAdd[index].address_add);
        $('#moa_partner_email_edit').val(listTempPartnerMOAAdd[index].email_add);
        $('#moa_sign_date_partner_edit').val(listTempPartnerMOAAdd[index].sign_date_mou_add);
        $('#moa_partner_specialization_edit').val(listTempPartnerMOAAdd[index].specialization_add);
        $('#moa_partner_phone_edit').val(listTempPartnerMOAAdd[index].phone_add);
        $('#moa_partner_id_edit').val(listTempPartnerMOAAdd[index].partner_id);
    }

    function confirm_delete_temp_moa(index) {
        Swal.fire({
            title: "Are you sure?",
            text: "You won't be able to revert this!",
            icon: "warning",
            showCancelButton: true,
            confirmButtonText: "Yes, delete it!",
            cancelButtonText: "No, cancel!",
            reverseButtons: true
        }).then(function (result) {
            if (result.isConfirmed) {
                resetTableMOA();
                listTempPartnerMOAAdd.splice(index, 1);
                initTableMOA();
            }
        })
    }

    function initTableMOA() {
        var HTMLdata = null;
        for (idx = 0; idx < listTempPartnerMOAAdd.length; idx++) {
            HTMLdata += '<tr id="tempMOA' + idx + '" "class="MOAPartnerTempList">';
            HTMLdata += '<td class="text-center">' + (idx + 1) + '</td>';
            HTMLdata += '<td class="text-center">' + listTempPartnerMOAAdd[idx].partnername_add + '</td>';
            HTMLdata += '<td class="text-center">' + listTempPartnerMOAAdd[idx].represent_add + '</td>';
            HTMLdata += '<td class="text-center">' + listTempPartnerMOAAdd[idx].phone_add + '</td>';
            HTMLdata += '<td class="text-center">' + listTempPartnerMOAAdd[idx].email_add + '</td>';
            var buttonEdit = '<a onclick="loadEditTempMOA(' + idx + ')" href="#edit_partner_moa" data-toggle="modal" class="btn btn-sm btn-light-primary px-6 font-weight-bold" style="margin-right: 10px;">Sửa</a>';
            var buttonDel = '<a onclick="confirm_delete_temp_moa(' + (idx) + ')" class="btn btn-sm btn-light-danger px-6 font-weight-bold" data-toggle="modal">Xóa</a>'
            HTMLdata += '<td class="text-center">' + buttonEdit + buttonDel + '</td>';
            HTMLdata += '</tr>';
        }
        $('#moa-partner-table').append(HTMLdata);
    }

    function resetTableMOA() {
        for (idx = 0; idx < listTempPartnerMOAAdd.length; idx++) {
            $("#tempMOA" + idx).remove();
        }
    }

    function initAndRefreshTableMOAAdd() {
        resetTableMOA();
        initTableMOA();
    }

    function clearInputAddMOA() {
        document.getElementById("moa_partner_name_add").value = "";
        document.getElementById("moa_partner_represent_add").value = "";
        document.getElementById("moa_partner_specialization_add").value = "";
        document.getElementById("moa_partner_nation_add").value = "";
        document.getElementById("moa_partner_website_add").value = "";
        document.getElementById("moa_partner_address_add").value = "";
        document.getElementById("moa_partner_email_add").value = "";
        document.getElementById("moa_sign_date_partner_add").value = "";
        document.getElementById("moa_partner_phone_add").value = "";
        $('#moa_partner_scope_add').empty();
    }

    function addToTempMOA() {
        var TempObj = {
            partnername_add: document.getElementById("moa_partner_name_add").value,
            represent_add: document.getElementById("moa_partner_represent_add").value,
            specialization_add: $("#moa_partner_specialization_add").val(),
            nation_add: document.getElementById("moa_partner_nation_add").value,
            website_add: document.getElementById("moa_partner_website_add").value,
            address_add: document.getElementById("moa_partner_address_add").value,
            email_add: document.getElementById("moa_partner_email_add").value,
            sign_date_moa_add: document.getElementById("moa_sign_date_partner_add").value,
            phone_add: document.getElementById("moa_partner_phone_add").value,
            coop_scope_add: $("#moa_partner_scope_add").val(),
            partner_id: document.getElementById("moa_partner_id_add").value,
            list_scope: listScopesMOA
        }
        listScopesMOA = [];
        listTempPartnerMOAAdd.push(TempObj);
        clearInputAddMOA();
        initAndRefreshTableMOAAdd();
    }

    function editTempMOA() {
        var index = $("#idx_edit_moa").val();
        listTempPartnerMOAAdd[index].partnername_add = document.getElementById("moa_partner_name_edit").value;
        listTempPartnerMOAAdd[index].represent_add = document.getElementById("moa_partner_represent_edit").value;
        listTempPartnerMOAAdd[index].specialization_add = $("#moa_partner_specialization_edit").val();
        listTempPartnerMOAAdd[index].nation_add = document.getElementById("moa_partner_nation_edit").value;
        listTempPartnerMOAAdd[index].website_add = document.getElementById("moa_partner_website_edit").value;
        listTempPartnerMOAAdd[index].address_add = document.getElementById("moa_partner_address_edit").value;
        listTempPartnerMOAAdd[index].email_add = document.getElementById("moa_partner_email_edit").value;
        listTempPartnerMOAAdd[index].sign_date_mou_add = document.getElementById("moa_sign_date_partner_edit").value;
        listTempPartnerMOAAdd[index].phone_add = document.getElementById("moa_partner_phone_edit").value;
        listTempPartnerMOAAdd[index].coop_scope_add = $("#moa_partner_scope_edit").val();
        listTempPartnerMOAAdd[index].partner_id = document.getElementById("moa_partner_id_edit").value;
        listTempPartnerMOAAdd[index].list_scope = listScopesMOA;
        listScopesMOA = [];
        initAndRefreshTableMOAAdd();
    }

    function preventEditMOA() {
        document.getElementById("edit_moa_partner_button").setAttribute('disabled', '');
    }

    function preventAddMOA() {
        document.getElementById("add_moa_partner_button").setAttribute('disabled', '');
    }

    function clearInputAdd() {
        document.getElementById("moa_partner_name_add").value = "";
        document.getElementById("moa_partner_represent_add").value = "";
        document.getElementById("moa_partner_specialization_add").value = "";
        document.getElementById("moa_partner_nation_add").value = "";
        document.getElementById("moa_partner_website_add").value = "";
        document.getElementById("moa_partner_address_add").value = "";
        document.getElementById("moa_partner_email_add").value = "";
        document.getElementById("moa_sign_date_partner_add").value = "";
        document.getElementById("moa_partner_phone_add").value = "";
        document.getElementById("moa_partner_scope_add").value = "";
    }

    function updateListScopeMOA(data){
        $('#moa_partner_scope_add').empty();
        var HTMLScopesdata = "";
        for (j = 0; j < data.length; j++) {
            HTMLScopesdata += '<option value = "' + data[j].scope_id + '">' + data[j].scope_abbreviation + '</option>';
            var obj = {
                scope_id: data[j].scope_id,
                scope_abbreviation: data[j].scope_abbreviation
            }
            listScopesMOA.push(obj);
        }
        $('#moa_partner_scope_add').append(HTMLScopesdata);
    }

    function updateListScopeMOAEdit(data) {
        $('#moa_partner_scope_edit').empty();
        var HTMLScopesdata = "";
        for (j = 0; j < data.length; j++) {
            HTMLScopesdata += '<option value = "' + data[j].scope_id + '">' + data[j].scope_abbreviation + '</option>';
            var obj = {
                scope_id: data[j].scope_id,
                scope_abbreviation: data[j].scope_abbreviation
            }
            listScopesMOA.push(obj);
        }
        $('#moa_partner_scope_edit').append(HTMLScopesdata);
    }

    function checkPartnerEditMOA(){
        var partner_name = document.getElementById("moa_partner_name_edit").value;
        var em = { partner_name: partner_name };
        $.ajax({
            url: "@Url.Action("GetMOAScopesByPartner", "MOA")",
            type: "POST",
            data: JSON.stringify(em),
            contentType: "application/json;charset=utf-8",
            datatype: "json",
            success: function (data) {
                updateListScopeMOAEdit(data);
                document.getElementById("edit_moa_partner_button").removeAttribute('disabled');
            },
            error: function () {
                //alert("fail");
            }
        });
        $.ajax({
            url: "@Url.Action("CheckPartner", "MOA")",
            type: "POST",
            data: JSON.stringify(em),
            contentType: "application/json;charset=utf-8",
            datatype: "json",
            success: function (data) {
                if (data == "") {

                } else {
                    document.getElementById("moa_partner_represent_edit").value = data.contact_point_name == null ? "" : data.contact_point_name;
                    document.getElementById("moa_partner_website_edit").value = data.website == null ? "" : data.website;
                    document.getElementById("moa_partner_address_edit").value = data.address == null ? "" : data.address;
                    document.getElementById("moa_partner_email_edit").value = data.contact_point_email == null ? "" : data.contact_point_email;
                    document.getElementById("moa_partner_nation_edit").value = data.country_name == null ? "" : data.country_name;
                    document.getElementById("moa_partner_phone_edit").value = data.contact_point_phone == null ? "" : data.contact_point_phone;
                    document.getElementById("moa_partner_id_edit").value = data.partner_id == null ? "" : data.partner_id;
                    document.getElementById("moa_partner_specialization_edit").value = data.specialization_name == null ? "" : data.specialization_name;
                }
                document.getElementById("edit_moa_partner_button").removeAttribute('disabled');
            },
            error: function () {
                //alert("fail");
            }
        });
    }

    function checkPartnerAddMOA() {
        var partner_name = document.getElementById("moa_partner_name_add").value;
        var em = { partner_name: partner_name };
        $.ajax({
            url: "@Url.Action("GetMOAScopesByPartner", "MOA")",
            type: "POST",
            data: JSON.stringify(em),
            contentType: "application/json;charset=utf-8",
            datatype: "json",
            success: function (data) {
                updateListScopeMOA(data);
                document.getElementById("add_moa_partner_button").removeAttribute('disabled');
            },
            error: function () {
                //alert("fail");
            }
        });
        $.ajax({
            url: "@Url.Action("CheckPartner", "MOA")",
            type: "POST",
            data: JSON.stringify(em),
            contentType: "application/json;charset=utf-8",
            datatype: "json",
            success: function (data) {
                if (data == "") {

                } else {
                    document.getElementById("moa_partner_represent_add").value = data.contact_point_name == null ? "" : data.contact_point_name;
                    document.getElementById("moa_partner_website_add").value = data.website == null ? "" : data.website;
                    document.getElementById("moa_partner_address_add").value = data.address == null ? "" : data.address;
                    document.getElementById("moa_partner_email_add").value = data.contact_point_email == null ? "" : data.contact_point_email;
                    document.getElementById("moa_partner_nation_add").value = data.country_name == null ? "" : data.country_name;
                    document.getElementById("moa_partner_phone_add").value = data.contact_point_phone == null ? "" : data.contact_point_phone;
                    document.getElementById("moa_partner_id_add").value = data.partner_id == null ? "" : data.partner_id;
                    document.getElementById("moa_partner_specialization_add").value = data.specialization_name == null ? "" : data.specialization_name;
                }
                document.getElementById("add_moa_partner_button").removeAttribute('disabled');
            },
            error: function () {
                //alert("fail");
            }
        });
    }

    $(document).ready(function () {
        $("#moa_partner_name_add option").each(function () {
            listPartnersMOA.push({
                partner_name: $(this).text()
            });
        });
    });

    function doneStep() {
        if (listTempPartnerMOAAdd.length == 0) {
            toastr.error('Chưa có đối tác nào được thêm');
        } else {
            $('#add_moa_modal').modal('hide');
            toastr.success('Thêm thành công');
            addMOA();
        }
    }

    function confirm_delete_moa(id){
        var link = '@Url.Action("Delete_Moa", "MOA")'
            Swal.fire({
                title: "Are you sure?",
                text: "You won't be able to revert this!",
                icon: "warning",
                showCancelButton: true,
                confirmButtonText: "Yes, delete it!",
                cancelButtonText: "No, cancel!",
                reverseButtons: true
            }).then(function (result) {
                if (result.value) {
                    $.ajax({
                        url: link,
                        data: { moa_id : id },
                        success: function (data) {
                            if (data = "") {
                                Swal.fire("Good job!", "You clicked the button!", "error");
                            } else {
                                Swal.fire("Deleted!", "Your file has been deleted.", "success")
                            }
                        },
                        error: function (data) {
                            Swal.fire("Good job!", "You clicked the button!", "error");
                        },
                    })
                }
            })
    }
</script>
}
